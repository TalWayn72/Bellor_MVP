# ×ª×§×œ×•×ª ×¤×ª×•×—×•×ª - Bellor MVP

**×ª××¨×™×š ×¢×“×›×•×Ÿ:** 8 ×¤×‘×¨×•××¨ 2026
**××¦×‘:** ×˜×•×¤×œ ×‘×”×¦×œ×—×” âœ…

---

## ×¡×™×›×•× ×ª×§×œ×•×ª

| ×§×˜×’×•×¨×™×” | ××¡×¤×¨ ×ª×§×œ×•×ª | ×—×•××¨×” | ×¡×˜×˜×•×¡ |
|----------|-------------|--------|--------|
| TypeScript Build | 30 | ğŸ”´ ×§×¨×™×˜×™ | âœ… ×ª×•×§×Ÿ |
| TypeScript Chat Service | 19 | ğŸ”´ ×§×¨×™×˜×™ | âœ… ×ª×•×§×Ÿ |
| Unit Tests | 2 | ğŸŸ¡ ×‘×™× ×•× ×™ | âœ… ×ª×•×§×Ÿ |
| ESLint Config | 1 | ğŸŸ¡ ×‘×™× ×•× ×™ | âœ… ×ª×•×§×Ÿ |
| Missing Scripts | 1 | ğŸŸ¢ × ××•×š | âœ… ×ª×•×§×Ÿ |
| Test Mock Hoisting | 2 | ğŸŸ¡ ×‘×™× ×•× ×™ | âœ… ×ª×•×§×Ÿ |
| Frontend API Errors | 5 | ğŸ”´ ×§×¨×™×˜×™ | âœ… ×ª×•×§×Ÿ |
| Drawing/Photo Mix | 1 | ğŸ”´ ×§×¨×™×˜×™ | âœ… ×ª×•×§×Ÿ |
| Undefined Array Access | 5 | ğŸ”´ ×§×¨×™×˜×™ | âœ… ×ª×•×§×Ÿ |
| Console Errors (Chat/Socket/A11y) | 4 | ğŸ”´ ×§×¨×™×˜×™ | âœ… ×ª×•×§×Ÿ |
| Upload Routing Issues | 4 | ğŸ”´ ×§×¨×™×˜×™ | âœ… ×ª×•×§×Ÿ |
| **Polish: State Components** | 3 | ğŸŸ¢ ×©×™×¤×•×¨ | âœ… ×”×•×©×œ× |
| **E2E Testing: Playwright** | 7 | ğŸŸ¢ ×©×™×¤×•×¨ | âœ… ×”×•×©×œ× |
| **Console Errors (Feb 4)** | 4 | ğŸ”´ ×§×¨×™×˜×™ | âœ… ×ª×•×§×Ÿ |
| **Task Upload Errors (Feb 4)** | 2 | ğŸ”´ ×§×¨×™×˜×™ | âœ… ×ª×•×§×Ÿ |
| **ESLint & Test Coverage (Feb 4)** | 3 | ğŸŸ¡ ×‘×™× ×•× ×™ | âœ… ×ª×•×§×Ÿ |
| **Backend Tests Expansion (Feb 4)** | 166 | ğŸŸ¢ ×©×™×¤×•×¨ | âœ… ×”×•×©×œ× |
| **CORS/Chat/Location Errors (Feb 6)** | 4 | ğŸ”´ ×§×¨×™×˜×™ | âœ… ×ª×•×§×Ÿ |
| **Onboarding Save Error (Feb 6)** | 1 | ğŸ”´ ×§×¨×™×˜×™ | âœ… ×ª×•×§×Ÿ |
| **AUDIT-001: API Validation Hardening** | 8 | ğŸŸ¢ ×©×™×¤×•×¨ | âœ… ×”×•×©×œ× |
| **ISSUE-014: Database Empty + Date Issues (Feb 6)** | 6 | ğŸ”´ ×§×¨×™×˜×™ | âœ… ×ª×•×§×Ÿ |
| **ISSUE-015: TemporaryChats BIO Not Showing (Feb 6)** | 1 | ğŸŸ¡ ×‘×™× ×•× ×™ | âœ… ×ª×•×§×Ÿ |
| **ISSUE-016: Date Validation Defense in Depth (Feb 6)** | 4 | ğŸ”´ ×§×¨×™×˜×™ | âœ… ×ª×•×§×Ÿ |
| **ISSUE-017: Token Refresh Race Condition (Feb 6)** | 2 | ğŸ”´ ×§×¨×™×˜×™ | âœ… ×ª×•×§×Ÿ |
| **ISSUE-018: Date Format Mismatch ISO vs yyyy-MM-dd (Feb 6)** | 1 | ğŸŸ¡ ×‘×™× ×•× ×™ | âœ… ×ª×•×§×Ÿ |
| **ISSUE-019: AdminDashboard & Service Response Mismatch (Feb 6)** | 5 | ğŸ”´ ×§×¨×™×˜×™ | âœ… ×ª×•×§×Ÿ |
| **ISSUE-020: Centralized Demo Data System (Feb 7)** | 8 | ğŸŸ¢ ×©×™×¤×•×¨ | âœ… ×”×•×©×œ× (Phase 1-2) |
| **ISSUE-021: Chat Data Mapping Mismatch - userId=undefined (Feb 7)** | 6 | ğŸ”´ ×§×¨×™×˜×™ | âœ… ×ª×•×§×Ÿ |
| **TASK-001: File Size Enforcement - 150 Line Max (Feb 7-8)** | ~80 | ğŸŸ¢ ×©×™×¤×•×¨ | âœ… ×”×•×©×œ× |
| **TASK-002: Code Quality - any types cleanup (Feb 8)** | 136 | ğŸŸ¢ ×©×™×¤×•×¨ | âœ… ×”×•×©×œ× |
| **TASK-003: Code Quality - console.log â†’ Logger (Feb 8)** | 43 | ğŸŸ¢ ×©×™×¤×•×¨ | âœ… ×”×•×©×œ× |
| **TASK-004: Feature - Push Notification in Chat (Feb 8)** | 1 | ğŸŸ¡ ×‘×™× ×•× ×™ | âœ… ×”×•×©×œ× |
| **TASK-005: Feature - Audio Playback in Feed (Feb 8)** | 1 | ğŸŸ¡ ×‘×™× ×•× ×™ | âœ… ×”×•×©×œ× |
| **TASK-006: Feature - Story Viewer Modal (Feb 8)** | 1 | ğŸŸ¡ ×‘×™× ×•× ×™ | âœ… ×”×•×©×œ× |
| **TASK-007: Production Deployment Prep (Feb 8)** | 5 | ğŸŸ¢ ×©×™×¤×•×¨ | âœ… ×”×•×©×œ× |
| **TASK-008: Performance Baseline Documentation (Feb 8)** | 1 | ğŸŸ¢ ×©×™×¤×•×¨ | âœ… ×”×•×©×œ× |
| **TASK-009: Architecture Diagrams Documentation (Feb 8)** | 8 | ğŸŸ¢ ×©×™×¤×•×¨ | âœ… ×”×•×©×œ× |
| **TASK-010: Frontend Page Unit Tests (Feb 8)** | 98 | ğŸŸ¢ ×©×™×¤×•×¨ | âœ… ×”×•×©×œ× |
| **TASK-011: Test File Refactoring - Split Large Files (Feb 8)** | 5 | ğŸŸ¢ ×©×™×¤×•×¨ | âœ… ×”×•×©×œ× |
| **ISSUE-022: Profile Data Not Persisting (Feb 8)** | 14 | ğŸ”´ ×§×¨×™×˜×™ | âœ… ×ª×•×§×Ÿ |
| **ISSUE-023: SharedSpace Blank Page - React Hooks Violation (Feb 8)** | 1 | ğŸ”´ ×§×¨×™×˜×™ | âœ… ×ª×•×§×Ÿ |
| **ISSUE-024: UserProfile?id=undefined - camelCase/snake_case Mismatch (Feb 8)** | 15 | ğŸ”´ ×§×¨×™×˜×™ | âœ… ×ª×•×§×Ÿ |
| **TASK-012: Prometheus Alert Rules - P1-P4 Severity Tiers (Feb 8)** | 6 | ğŸŸ¢ ×©×™×¤×•×¨ | âœ… ×”×•×©×œ× |
| **TASK-013: PII Data Retention Policy Documentation (Feb 8)** | 1 | ğŸŸ¢ ×©×™×¤×•×¨ | âœ… ×”×•×©×œ× |
| **ISSUE-025: getUserById Unwrap Bug + aria-describedby Warnings (Feb 8)** | 7 | ğŸ”´ ×§×¨×™×˜×™ | âœ… ×ª×•×§×Ÿ |
| **TASK-014: Zod Validation on All Remaining API Routes (Feb 8)** | 7 | ğŸŸ¢ ×©×™×¤×•×¨ | âœ… ×”×•×©×œ× |
| **TASK-015: Frontend Page Unit Tests - Full Coverage (Feb 8)** | 36 | ğŸŸ¢ ×©×™×¤×•×¨ | âœ… ×”×•×©×œ× |
| **TASK-016: Admin Message Deletion Feature (Feb 8)** | 1 | ğŸŸ¡ ×‘×™× ×•× ×™ | âœ… ×”×•×©×œ× |
| **TASK-017: PRD Comprehensive Rewrite (Feb 8)** | 1 | ğŸŸ¢ ×©×™×¤×•×¨ | âœ… ×”×•×©×œ× |
| **TASK-018: Mobile Release Checklist (Feb 8)** | 1 | ğŸŸ¢ ×©×™×¤×•×¨ | âœ… ×”×•×©×œ× |
| **TASK-019: Historical Documentation Cleanup (Feb 8)** | 6 | ğŸŸ¢ ×©×™×¤×•×¨ | âœ… ×”×•×©×œ× |
| **TASK-020: Response Transformer Layer - camelCase Normalization (Feb 8)** | 4 | ğŸ”´ ×§×¨×™×˜×™ | âœ… ×”×•×©×œ× |
| **TASK-021: README Professional Rewrite (Feb 8)** | 1 | ğŸŸ¢ ×©×™×¤×•×¨ | âœ… ×”×•×©×œ× |
| **TASK-022: DB Transaction Safety (Feb 8)** | 3 | ğŸ”´ ×§×¨×™×˜×™ | âœ… ×”×•×©×œ× |
| **TASK-023: Standardized AppError Class (Feb 8)** | 5 | ğŸŸ¡ ×‘×™× ×•× ×™ | âœ… ×”×•×©×œ× |
| **TASK-024: Duplicate bcrypt Removal (Feb 8)** | 1 | ğŸŸ¡ ×‘×™× ×•× ×™ | âœ… ×”×•×©×œ× |
| **TASK-025: CI npm audit Fix (Feb 8)** | 1 | ğŸŸ¡ ×‘×™× ×•× ×™ | âœ… ×”×•×©×œ× |
| **TASK-026: Frontend .jsâ†’.ts Migration (Feb 8)** | 14 | ğŸ”´ ×§×¨×™×˜×™ | âœ… ×”×•×©×œ× |
| **TASK-027: Production console.log Removal (Feb 8)** | 7 | ğŸŸ¡ ×‘×™× ×•× ×™ | âœ… ×”×•×©×œ× |
| **TASK-028: PrivateChat 150-Line Split (Feb 8)** | 1 | ğŸŸ¢ ×©×™×¤×•×¨ | âœ… ×”×•×©×œ× |
| **TASK-029: Endpoint-Specific Rate Limiting (Feb 8)** | 3 | ğŸŸ¡ ×‘×™× ×•× ×™ | âœ… ×”×•×©×œ× |
| **TASK-030: Circuit Breaker for External APIs (Feb 8)** | 3 | ğŸŸ¡ ×‘×™× ×•× ×™ | âœ… ×”×•×©×œ× |
| **TASK-031: Redis Cache-Aside Pattern (Feb 8)** | 2 | ğŸŸ¡ ×‘×™× ×•× ×™ | âœ… ×”×•×©×œ× |
| **TASK-032: Global Error Handler (Feb 8)** | 1 | ğŸŸ¡ ×‘×™× ×•× ×™ | âœ… ×”×•×©×œ× |
| **TASK-033: JWT Admin Caching (Feb 8)** | 3 | ğŸŸ¡ ×‘×™× ×•× ×™ | âœ… ×”×•×©×œ× |
| **TASK-034: WebSocket Heartbeat + TTL Fix (Feb 8)** | 1 | ğŸŸ¡ ×‘×™× ×•× ×™ | âœ… ×”×•×©×œ× |
| **TASK-035: Missing Database Indexes (Feb 8)** | 6 | ğŸŸ¡ ×‘×™× ×•× ×™ | âœ… ×”×•×©×œ× |
| **TASK-036: Auth Route Guards (Feb 8)** | 2 | ğŸŸ¡ ×‘×™× ×•× ×™ | âœ… ×”×•×©×œ× |
| **TASK-037: Context Re-Render Optimization (Feb 8)** | 2 | ğŸŸ¡ ×‘×™× ×•× ×™ | âœ… ×”×•×©×œ× |
| **TASK-038: Image Lazy Loading (Feb 8)** | 15 | ğŸŸ¢ ×©×™×¤×•×¨ | âœ… ×”×•×©×œ× |
| **TASK-039: Accessibility Fixes (Feb 8)** | 10 | ğŸŸ¢ ×©×™×¤×•×¨ | âœ… ×”×•×©×œ× |
| **TASK-040: useEffect Cleanup + Memory Leaks (Feb 8)** | 2 | ğŸŸ¡ ×‘×™× ×•× ×™ | âœ… ×”×•×©×œ× |
| **TASK-041: E2E Tests in CI Pipeline (Feb 8)** | 1 | ğŸŸ¡ ×‘×™× ×•× ×™ | âœ… ×”×•×©×œ× |
| **TASK-042: K8s NetworkPolicy + RBAC (Feb 8)** | 2 | ğŸŸ¢ ×©×™×¤×•×¨ | âœ… ×”×•×©×œ× |
| **TASK-043: Prometheus Business Metrics (Feb 8)** | 1 | ğŸŸ¢ ×©×™×¤×•×¨ | âœ… ×”×•×©×œ× |
| **TASK-044: PgBouncer Pool Sizing (Feb 8)** | 1 | ğŸŸ¢ ×©×™×¤×•×¨ | âœ… ×”×•×©×œ× |

**×¡×”"×›:** 523+ ×¤×¨×™×˜×™× ×–×•×”×• â†’ 523+ ×˜×•×¤×œ×• âœ…

---

## âœ… TASK-022 to TASK-044: Comprehensive Technical Review Implementation (8 ×¤×‘×¨×•××¨ 2026)

**×¡×˜×˜×•×¡:** âœ… ×”×•×©×œ×
**×—×•××¨×”:** ğŸ”´ ×§×¨×™×˜×™ / ğŸŸ¡ ×‘×™× ×•× ×™ / ğŸŸ¢ ×©×™×¤×•×¨
**×ª××¨×™×š:** 8 February 2026

**×ª×™××•×¨:** Deep technical review by 3 parallel agents identified 80+ concrete findings across backend, frontend, and infrastructure. 23 tasks selected and implemented by 6 parallel agents. 88 files changed, +616/-2057 lines.

**Category A - Backend Reliability (CRITICAL):**
- **TASK-022:** DB Transaction Safety - Wrapped paired writes in `prisma.$transaction()` in responses.service.ts, likes-matching.service.ts, chat-messaging.handler.ts. Replaced check-then-act with `upsert()` for likes.
- **TASK-023:** Standardized AppError class with code+status. All services throw AppError, controllers map to HTTP status. Global error handler in app.ts.
- **TASK-024:** Removed duplicate `bcryptjs` dependency, kept native `bcrypt` only.
- **TASK-025:** Removed `continue-on-error: true` from CI npm audit step.

**Category B - Frontend Type Safety (CRITICAL):**
- **TASK-026:** Converted 14 frontend API services from .js to .ts with typed interfaces and return values (apiClient, authService, chatService, userService, likeService, storyService, followService, missionService, notificationService, reportService, responseService, uploadService, achievementService, adminService + adminAnalytics).
- **TASK-027:** Removed all console.log from production code (apiClient, FeedPostHeader, and others).
- **TASK-028:** Split PrivateChat.jsx (152 lines â†’ under 150) by extracting PrivateChatConstants.

**Category C - Backend Architecture (HIGH):**
- **TASK-029:** Endpoint-specific rate limiting config (login: 5/15min, register: 3/hr, chat: 30/min, search: 20/min, upload: 10/min).
- **TASK-030:** Circuit breaker pattern for Stripe, Firebase, Resend via custom CircuitBreaker class.
- **TASK-031:** Redis cache-aside pattern with CacheService.getOrSet() for user profiles (5min), stories (2min), missions (5min), achievements (10min).
- **TASK-032:** Global error handler via `app.setErrorHandler()` + `process.on('unhandledRejection')`.
- **TASK-033:** Cached `isAdmin` in JWT payload - eliminates N+1 DB query on admin endpoints.

**Category C - DB/WebSocket (HIGH):**
- **TASK-034:** WebSocket heartbeat (ping 25s, timeout 20s), reduced TTL from 3600sâ†’300s, periodic presence refresh, stale socket cleanup.
- **TASK-035:** Added 6+ database indexes: birthDate, gender, preferredLanguage, createdAt, compound [isActive,gender], [isActive,lastActiveAt], [chatRoomId,createdAt], [userId,createdAt], [missionId,createdAt].

**Category D - Frontend Architecture (HIGH):**
- **TASK-036:** Auth route guards via ProtectedRoute component - splash screen during auth loading, admin route validation.
- **TASK-037:** Context re-render optimization - useMemo on AuthContext and SocketProvider values.
- **TASK-038:** Image lazy loading (`loading="lazy"`) added to all img tags across 15+ components.
- **TASK-039:** Accessibility fixes - aria-labels on ChatInput buttons, htmlFor on DiscoverFilters inputs, focus management improvements.
- **TASK-040:** useEffect cleanup - proper cleanup returns in useChatRoom, isMounted checks in MatchCard.

**Category E - Infrastructure (HIGH):**
- **TASK-041:** E2E tests added to CI pipeline with Playwright containers, PostgreSQL, Redis services.
- **TASK-042:** K8s NetworkPolicy (pod-to-pod traffic restriction) + RBAC (service accounts, minimal permissions).
- **TASK-043:** Prometheus business metrics - custom counters for chat_messages_total, matches_created_total, payments_total, registrations_total.
- **TASK-044:** PgBouncer pool sizing increased from 50â†’100 per replica, MAX_CLIENT_CONN 1000â†’2000.

**×§×‘×¦×™× ××•×©×¤×¢×™×:** 88 files (see git diff for full list)

---

## âœ… ISSUE-025: getUserById Unwrap Bug + aria-describedby Warnings (8 ×¤×‘×¨×•××¨ 2026)

**×¡×˜×˜×•×¡:** âœ… ×ª×•×§×Ÿ
**×—×•××¨×”:** ğŸ”´ ×§×¨×™×˜×™
**×ª××¨×™×š:** 8 February 2026

**×ª×™××•×¨ ×”×‘×¢×™×”:**
1. **getUserById unwrap bug**: `userService.getUserById()` returns `{ user: {...} }` wrapper object. FeedPost, CommentsList, StarSendersModal, and FeedPost mentionedUsers passed the wrapper to `transformUser()` or used it directly, causing all user fields (id, nickname, age, profile_images) to be undefined. This caused: clicking avatar did nothing (no user ID for navigation), "User â€¢ 25" shown instead of real name/age, and missing profile images.
2. **aria-describedby warnings**: UserBioDialog, StoryViewer had missing/invalid `aria-describedby` attributes causing Radix UI console warnings.

**×¤×ª×¨×•×Ÿ:**
1. Fixed all 4 components to unwrap `result?.user || result` before using user data
2. Added proper `aria-describedby` with matching description IDs to all dialog components
3. Added `id` field to FeedPost fallback userData for demo users
4. Added `userData?.id` as navigation fallback in FeedPostHeader

**×§×‘×¦×™× ××•×©×¤×¢×™×:**
- `apps/web/src/components/feed/FeedPost.jsx:68,78-82` - Unwrap getUserById + add id to fallback
- `apps/web/src/components/feed/FeedPostHeader.jsx:14-22` - Add userData.id fallback + logging
- `apps/web/src/components/comments/CommentsList.jsx:48` - Unwrap getUserById
- `apps/web/src/components/feed/StarSendersModal.jsx:39` - Unwrap getUserById
- `apps/web/src/components/user/UserBioDialog.jsx:72` - Fix aria-describedby
- `apps/web/src/components/stories/StoryViewer.jsx:18` - Add aria-describedby

---

## âœ… ISSUE-024: UserProfile?id=undefined - camelCase/snake_case Mismatch (8 ×¤×‘×¨×•××¨ 2026)

**×¡×˜×˜×•×¡:** âœ… ×ª×•×§×Ÿ
**×—×•××¨×”:** ğŸ”´ ×§×¨×™×˜×™
**×ª××¨×™×š:** 8 February 2026

**×ª×™××•×¨ ×”×‘×¢×™×”:** Clicking user avatars in SharedSpace navigated to `UserProfile?id=undefined`. Root cause: Prisma API returns camelCase fields (`userId`, `responseType`) but frontend components expect snake_case (`user_id`, `response_type`). Demo data worked because it already used snake_case.

**×¤×ª×¨×•×Ÿ:** Created data transformer layer at the API service boundary to normalize camelCase â†’ snake_case. Added navigation guards to prevent `id=undefined` navigation in all 10 components.

**×§×‘×¦×™× ××•×©×¤×¢×™×:**
- `apps/web/src/utils/responseTransformer.js` - NEW: transformer functions for responses, likes, comments, stories, follows
- `apps/web/src/utils/index.ts` - Added transformer exports
- `apps/web/src/api/services/responseService.js` - Applied transformResponses/transformResponse
- `apps/web/src/api/services/likeService.js` - Applied transformLikes in getReceivedLikes, getSentLikes, getResponseLikes
- `apps/web/src/api/services/storyService.js` - Applied transformStory/transformStories in getFeed, getMyStories, getStoriesByUser, getStoryById
- `apps/web/src/pages/UserProfile.jsx` - Added redirect guard for invalid userId
- `apps/web/src/components/feed/FeedPostHeader.jsx` - Guard + fallback to userId
- `apps/web/src/components/matches/MatchCard.jsx` - Guard + fallback to userId
- `apps/web/src/components/feed/ChatCarousel.jsx` - Guard + fallback to user_id
- `apps/web/src/components/chat/PrivateChatHeader.jsx` - Guard for undefined
- `apps/web/src/components/user/UserBioDialog.jsx` - Guard for undefined
- `apps/web/src/components/profile/FollowingCard.jsx` - Guard for undefined
- `apps/web/src/components/feed/MentionExtractor.jsx` - Guard for undefined
- `apps/web/src/components/discover/DiscoverCard.jsx` - Guard for undefined

---

## âœ… ISSUE-023: SharedSpace Blank Page - React Hooks Violation (8 ×¤×‘×¨×•××¨ 2026)

**×¡×˜×˜×•×¡:** âœ… ×ª×•×§×Ÿ
**×—×•××¨×”:** ğŸ”´ ×§×¨×™×˜×™
**×ª××¨×™×š:** 8 February 2026

**×ª×™××•×¨ ×”×‘×¢×™×”:** SharedSpace page showed blank white screen. Error: "Rendered more hooks than during the previous render". In `FeedPost.jsx`, a `useEffect` hook was placed after a conditional `return null`, violating React's Rules of Hooks.

**×¤×ª×¨×•×Ÿ:** Moved the audio cleanup `useEffect` to before the early return guard.

**×§×‘×¦×™× ××•×©×¤×¢×™×:**
- `apps/web/src/components/feed/FeedPost.jsx:88-90` - Moved useEffect before conditional return

---

## âœ… ISSUE-022: Profile Data Not Persisting (8 ×¤×‘×¨×•××¨ 2026)

**×¡×˜×˜×•×¡:** âœ… ×ª×•×§×Ÿ
**×—×•××¨×”:** ğŸ”´ ×§×¨×™×˜×™
**×ª××¨×™×š:** 8 February 2026

**×ª×™××•×¨ ×”×‘×¢×™×”:** User profile fields (phone, occupation, education, interests), privacy settings, and notification preferences were not being saved or loaded. Root causes: (1) DB missing columns, (2) backend service silently dropping unsupported fields, (3) frontend pages had no save/load logic.

**×¤×ª×¨×•×Ÿ:** Added 14 new fields to Prisma schema, updated backend service to handle all fields, rewrote PrivacySettings/NotificationSettings/EditProfile pages with auto-save and load-from-profile logic.

**×§×‘×¦×™× ××•×©×¤×¢×™×:**
- `apps/api/prisma/schema.prisma` - Added 14 fields (phone, occupation, education, interests, 5 privacy, 5 notification)
- `apps/api/src/services/users/users-profile.service.ts` - Handle all new fields in buildUpdateData + USER_PROFILE_SELECT
- `apps/api/src/services/users/users.types.ts` - Updated UpdateUserProfileInput interface
- `apps/api/src/controllers/users/users-schemas.ts` - Added Zod validation for new boolean fields
- `apps/api/src/routes/v1/auth/auth-handlers.ts` - Return new fields in handleGetMe
- `apps/web/src/pages/PrivacySettings.jsx` - Load saved values, auto-save on toggle
- `apps/web/src/pages/NotificationSettings.jsx` - Load saved values, auto-save with field mapping
- `apps/web/src/pages/EditProfile.jsx` - Send all fields in handleSave, load defaults correctly
- `apps/web/src/pages/FilterSettings.jsx` - Sync global state after save

---

## âœ… TASK-011: Test File Refactoring - Split Large Files (8 ×¤×‘×¨×•××¨ 2026)

**×¡×˜×˜×•×¡:** âœ… ×”×•×©×œ×
**×—×•××¨×”:** ğŸŸ¢ ×©×™×¤×•×¨
**×ª××¨×™×š:** 8 ×¤×‘×¨×•××¨ 2026

**×ª×™××•×¨:** Split 5 large test files (607-1,262 lines each) into smaller modules under 300 lines each, following the project's 150-line max rule (with test file exception).

**×§×‘×¦×™× ×©×¤×•×¦×œ×•:**
| Original File | Lines | Split Into | New File Count |
|---|---|---|---|
| `services/users.service.test.ts` | 1,262 | users-list, users-getby, users-profile, users-language, users-search, users-data, users-delete + helpers | 8 |
| `services/auth.service.test.ts` | 826 | auth-register, auth-login, auth-tokens, auth-password + helpers | 5 |
| `integration/websocket.integration.test.ts` | 815 | websocket-connection, websocket-presence, websocket-chat, websocket-chat-actions, websocket-edge-cases + helpers | 6 |
| `services/chat.service.test.ts` | 635 | chat-rooms, chat-messages, chat-actions + helpers | 4 |
| `integration/auth.integration.test.ts` | 607 | auth-register, auth-login, auth-password + helpers | 4 |

**×ª×•×¦××•×ª:**
- 5 original files deleted, 27 new files created (22 test files + 5 helper files)
- All files under 300 lines (max: 255 lines)
- All 222 tests preserved (0 tests lost)
- Pre-existing failures preserved (no regressions)

---

## âœ… TASK-010: Frontend Page Unit Tests (8 ×¤×‘×¨×•××¨ 2026)

**×¡×˜×˜×•×¡:** âœ… ×”×•×©×œ×
**×—×•××¨×”:** ğŸŸ¢ ×©×™×¤×•×¨
**×ª××¨×™×š:** 8 ×¤×‘×¨×•××¨ 2026

**×ª×™××•×¨:** × ×•×¦×¨×• 18 ×§×‘×¦×™ ×‘×“×™×§×•×ª ×™×—×™×“×” ×—×“×©×™× ×¢×‘×•×¨ ×“×¤×™ frontend ×©×œ× ×”×™×• ××›×•×¡×™× ×‘×‘×“×™×§×•×ª. ×¡×š ×”×›×œ 98 ×‘×“×™×§×•×ª ×—×“×©×•×ª.

**×§×‘×¦×™× ×©× ×•×¦×¨×•:**
| ×§×•×‘×¥ ×‘×“×™×§×” | ×“×£ | ×‘×“×™×§×•×ª |
|------------|-----|--------|
| `apps/web/src/pages/VideoDate.test.jsx` | VideoDate | 4 |
| `apps/web/src/pages/CompatibilityQuiz.test.jsx` | CompatibilityQuiz | 6 |
| `apps/web/src/pages/Discover.test.jsx` | Discover | 4 |
| `apps/web/src/pages/Achievements.test.jsx` | Achievements | 6 |
| `apps/web/src/pages/Premium.test.jsx` | Premium | 6 |
| `apps/web/src/pages/ReferralProgram.test.jsx` | ReferralProgram | 5 |
| `apps/web/src/pages/ProfileBoost.test.jsx` | ProfileBoost | 5 |
| `apps/web/src/pages/Analytics.test.jsx` | Analytics | 5 |
| `apps/web/src/pages/DateIdeas.test.jsx` | DateIdeas | 5 |
| `apps/web/src/pages/IceBreakers.test.jsx` | IceBreakers | 5 |
| `apps/web/src/pages/VirtualEvents.test.jsx` | VirtualEvents | 4 |
| `apps/web/src/pages/SafetyCenter.test.jsx` | SafetyCenter | 7 |
| `apps/web/src/pages/Feedback.test.jsx` | Feedback | 6 |
| `apps/web/src/pages/FAQ.test.jsx` | FAQ | 7 |
| `apps/web/src/pages/UserVerification.test.jsx` | UserVerification | 6 |
| `apps/web/src/pages/AudioTask.test.jsx` | AudioTask | 5 |
| `apps/web/src/pages/VideoTask.test.jsx` | VideoTask | 6 |
| `apps/web/src/pages/CreateStory.test.jsx` | CreateStory | 6 |

**×›×™×¡×•×™ ×‘×“×™×§×•×ª:**
- Render tests (renders without crashing)
- Key UI elements (headings, buttons, sections)
- Loading states
- Async data loading (findByText for queries)
- Mock patterns: @/api, useCurrentUser, BackButton, ThemeProvider, child components

---

## âœ… TASK-001: File Size Enforcement - 150 Line Maximum (7-8 ×¤×‘×¨×•××¨ 2026)

**×¡×˜×˜×•×¡:** âœ… ×”×•×©×œ×
**×—×•××¨×”:** ğŸŸ¢ ×©×™×¤×•×¨
**×ª××¨×™×š:** 7-8 ×¤×‘×¨×•××¨ 2026

**×ª×™××•×¨:** ××›×™×¤×ª ××’×‘×œ×ª 150 ×©×•×¨×•×ª ××§×¡×™××•× ×œ×›×œ ×§×•×‘×¥ ×§×•×“ ××§×•×¨. ×¤×•×¦×œ×• ~80 ×§×‘×¦×™× ×’×“×•×œ×™× ×œ-~180 ×§×‘×¦×™× ×§×˜× ×™× ×™×•×ª×¨.

**×”×ª×§×“××•×ª:**
| Batch | ×ª×™××•×¨ | ×§×‘×¦×™× | ×¡×˜×˜×•×¡ |
|-------|--------|--------|--------|
| 0 | Update rules (CLAUDE.md, OPEN_ISSUES.md) | 2 | âœ… ×”×•×©×œ× |
| 1 | Largest files (1,897-653 lines) | 5 | âœ… ×”×•×©×œ× |
| 2 | Large backend (587-532 lines) | 5 | âœ… ×”×•×©×œ× |
| 3 | Frontend pages (400-512 lines) | 5 | âœ… ×”×•×©×œ× |
| 4 | Frontend 350-400 + services | 10 | âœ… ×”×•×©×œ× |
| 5 | Backend 300-467 lines | 12 | âœ… ×”×•×©×œ× |
| 6 | Frontend 230-291 lines | 9 | âœ… ×”×•×©×œ× |
| 7 | Backend 200-270 + Frontend 200-235 | 21 | âœ… ×”×•×©×œ× |
| 8 | Borderline files 150-215 lines | ~25 | âœ… ×”×•×©×œ× |

**×¡×™×›×•× ×¡×•×¤×™:**
- ~80 ×§×‘×¦×™× ×¤×•×¦×œ×•
- ~180 ×§×‘×¦×™× ×—×“×©×™× × ×•×¦×¨×•
- 537 ×‘×“×™×§×•×ª ×¢×•×‘×¨×•×ª (×œ×œ× ×©×™× ×•×™)
- Frontend build ×¢×•×‘×¨ ×‘×”×¦×œ×—×”
- Backward-compatible barrel re-exports

**×—×•×§×™× ×©× ×•×¡×¤×•:**
- `CLAUDE.md`: ğŸ“ Code Quality Rules - Maximum File Size (150 Lines)
- `CLAUDE.md`: Activity Tracking - ×›×œ ×¤×¢×™×œ×•×ª × ×¨×©××ª ×‘-OPEN_ISSUES.md

---

## âœ… ISSUE-021: Chat Data Mapping Mismatch - userId=undefined (7 ×¤×‘×¨×•××¨ 2026)

**×¡×˜×˜×•×¡:** âœ… ×ª×•×§×Ÿ
**×—×•××¨×”:** ğŸ”´ ×§×¨×™×˜×™
**×ª××¨×™×š:** 7 ×¤×‘×¨×•××¨ 2026

### ×ª×™××•×¨ ×”×‘×¢×™×”

**×‘×¢×™×” ××§×•×¨×™×ª:** ×œ×—×™×¦×” ×¢×œ ×ª××•× ×ª ××©×ª××© ×‘-SharedSpace ×’×¨××” ×œ× ×™×•×•×˜ ×œ-`PrivateChat?userId=undefined` ×•×§×¨×™×¡×ª ×”×“×£ ×¢× ×©×’×™××ª `TypeError: Cannot read properties of undefined`.

**×©×•×¨×© ×”×‘×¢×™×”:** ×”-Backend API ××—×–×™×¨ ×¦'××˜×™× ×‘×¤×•×¨××˜ `{ otherUser: { id, first_name, ... } }`, ××‘×œ ×”-Frontend × ×™×¡×” ×œ×’×©×ª ×œ×©×“×•×ª ×©×œ× ×§×™×™××™×: `chat.user1_id`, `chat.user2_id`, `chat.user1_name`, `chat.user2_image`.

### ×§×‘×¦×™× ××•×©×¤×¢×™×

| ×§×•×‘×¥ | ×©×•×¨×•×ª | ×‘×¢×™×” |
|-------|--------|-------|
| `apps/web/src/pages/SharedSpace.jsx` | 140-149, 236 | ××™×¤×•×™ ×©×’×•×™ + × ×™×•×•×˜ ×œ-PrivateChat ×‘××§×•× UserProfile |
| `apps/web/src/pages/TemporaryChats.jsx` | 152-154 | ××™×¤×•×™ ×©×’×•×™ ×©×œ otherUser |
| `apps/web/src/pages/PrivateChat.jsx` | 102-107 | ××™×¤×•×™ ×©×’×•×™ ×©×œ otherUser ××ª×•×š chat |
| `apps/web/src/pages/VideoDate.jsx` | 29 | ××™×¤×•×™ ×©×’×•×™ ×©×œ otherUser ××ª×•×š chat |
| `apps/web/src/pages/AdminChatMonitoring.jsx` | 161 | ××™×¤×•×™ ×©×’×•×™ ×©×œ user IDs |
| `apps/web/src/data/demoData.js` | 555-596 | Demo data ×—×¡×¨ ×©×“×” otherUser |

### ×¤×ª×¨×•×Ÿ

1. **×¢×“×›×•×Ÿ ××™×¤×•×™ × ×ª×•× ×™×** - ×›×œ ×”×“×¤×™× ×¢×•×“×›× ×• ×œ×”×©×ª××© ×‘-`chat.otherUser?.id`, `chat.otherUser?.first_name`, `chat.otherUser?.profile_images?.[0]`
2. **×©×™× ×•×™ × ×™×•×•×˜** - ×œ×—×™×¦×” ×¢×œ ××•×•×˜××¨ ×‘-SharedSpace ×× ×•×•×˜×ª ×¢×›×©×™×• ×œ-`UserProfile?id=` ×‘××§×•× `PrivateChat`
3. **×¢×“×›×•×Ÿ Demo Data** - `getDemoTempChats()` ×•-`createDemoChat()` ××—×–×™×¨×™× ×¢×›×©×™×• `otherUser` ×‘×¤×•×¨××˜ ×–×”×” ×œ-Backend

### ×‘×“×™×§×•×ª ×©× ×•×¡×¤×•/×¢×•×“×›× ×•

| ×§×•×‘×¥ ×‘×“×™×§×” | ×›×™×¡×•×™ |
|------------|-------|
| `apps/web/src/data/demoData.test.js` | ×‘×“×™×§×ª ×©×“×” otherUser ×‘-getDemoTempChats ×•-createDemoChat (25/25 ×¢×•×‘×¨×•×ª) |

---

## âœ… ISSUE-020: Centralized Demo Data System (7 ×¤×‘×¨×•××¨ 2026)

**×¡×˜×˜×•×¡:** âœ… ×”×•×©×œ× (Phase 1-2)
**×¡×•×’:** ğŸŸ¢ ×©×™×¤×•×¨
**×ª××¨×™×š:** 7 ×¤×‘×¨×•××¨ 2026

### ×ª×™××•×¨ ×”×‘×¢×™×”

**×‘×¢×™×” ××§×•×¨×™×ª:** ×œ×—×™×¦×” ×¢×œ ××•×•×˜×¨ ××©×ª××© ×“××• ×‘-SharedSpace ×’×¨××” ×œ××¡×š ×©×—×•×¨ ×‘-PrivateChat.

**× ×™×ª×•×—:**
1. ×¤×•× ×§×¦×™×•×ª `getDemoX()` ××¤×•×–×¨×•×ª ×‘-10+ ×§×‘×¦×™×
2. IDs ×œ× ×¢×§×‘×™×™×: `demo-user-1`, `demo-match-user-1-romantic`, `mock-user`
3. ×¨×§ 2/14 services ×ª×•××›×™× ×‘×“××•
4. ××™×Ÿ ×”×’× ×” ×‘-Backend × ×’×“ ×¤×¢×•×œ×•×ª ×¢×œ ××©×ª××©×™ ×“××•

### ×¤×ª×¨×•×Ÿ - ××¢×¨×›×ª Demo Data ××¨×›×–×™×ª

**Phase 1: Frontend - demoData.js** âœ…
- ×™×¦×™×¨×ª ×§×•×‘×¥ ××¨×›×–×™ `apps/web/src/data/demoData.js` (~650 ×©×•×¨×•×ª)
- 5 ××©×ª××©×™ ×“××• ×¡×˜× ×“×¨×˜×™×™× (`demo-user-1` ×¢×“ `demo-user-5`)
- ×›×œ ×”×™×©×•×™×•×ª: responses, stories, notifications, likes, chats, follows
- 15+ helper functions: `isDemoUser`, `getDemoUser`, `getDemoResponses` ×•×›×•'
- 25 unit tests ×¢×•×‘×¨×™×

**Phase 2: Backend Security** âœ…
- ×™×¦×™×¨×ª `apps/api/src/utils/demoId.util.ts`
- ×¤×•× ×§×¦×™×•×ª: `isDemoUserId`, `isDemoId`, `rejectDemoId`, `DemoIdError`
- 26 unit tests ×¢×•×‘×¨×™×
- ×”×•×¡×¤×ª validation ×œ-3 controllers:
  - `likes.controller.ts` - likeUser, unlikeUser, likeResponse, unlikeResponse
  - `follows.controller.ts` - follow, unfollow
  - `chats.routes.ts` - createChat, sendMessage, deleteMessage

### ×§×‘×¦×™× ×©× ×•×¦×¨×•/×¢×•×“×›× ×•

| ×§×•×‘×¥ | ×¤×¢×•×œ×” | ×¡×˜×˜×•×¡ |
|------|-------|--------|
| `apps/web/src/data/demoData.js` | CREATE | âœ… Done |
| `apps/web/src/data/demoData.test.js` | CREATE | âœ… Done |
| `apps/web/src/test/setup.js` | CREATE | âœ… Done |
| `apps/api/src/utils/demoId.util.ts` | CREATE | âœ… Done |
| `apps/api/src/utils/demoId.util.test.ts` | CREATE | âœ… Done |
| `apps/api/src/controllers/likes.controller.ts` | UPDATE | âœ… Done |
| `apps/api/src/controllers/follows.controller.ts` | UPDATE | âœ… Done |
| `apps/api/src/routes/v1/chats.routes.ts` | UPDATE | âœ… Done |

### ×‘×“×™×§×•×ª ×©× ×•×¡×¤×•

| ×§×•×‘×¥ ×‘×“×™×§×” | ××¡×¤×¨ tests | ×›×™×¡×•×™ |
|------------|------------|-------|
| `demoData.test.js` | 25 | isDemoUser, getDemoUser, getDemoResponses, etc. |
| `demoId.util.test.ts` | 26 | isDemoUserId, isDemoId, rejectDemoId, DemoIdError |

### × ×•×ª×¨ ×œ×‘×™×¦×•×¢ (Phase 3-4)

| ××©×™××” | ×¢×“×™×¤×•×ª |
|-------|--------|
| ×¢×“×›×•×Ÿ 6 frontend services ×œ×©×™××•×© ×‘-demoData.js | High |
| × ×™×§×•×™ ×¤×•× ×§×¦×™×•×ª getDemoX ××ª×•×š components | Medium |
| ×‘×“×™×§×•×ª ×™×“× ×™×•×ª | Medium |

---

## âœ… ISSUE-019: AdminDashboard & Service Response Mismatch (6 ×¤×‘×¨×•××¨ 2026)

**×¡×˜×˜×•×¡:** âœ… ×ª×•×§×Ÿ
**×¡×•×’:** ğŸ”´ ×§×¨×™×˜×™
**×ª××¨×™×š:** 6 ×¤×‘×¨×•××¨ 2026

### ×ª×™××•×¨ ×”×‘×¢×™×”

**1. AdminDashboard ××¦×™×’ 0 ××©×ª××©×™×:**
- ×”×“×©×‘×•×¨×“ ××¨××” `Total Users: 0` ×œ××¨×•×ª ×©×™×© ××©×ª××©×™× ×‘××¢×¨×›×ª
- `Active Chats: 0` - ×¦'××˜×™× ×œ× × ×¡×¤×¨×™×

**2. Error sending message (500):**
```
Error sending message: AxiosError: Request failed with status code 500
at chatService.js:83:22
```

**3. Socket not connected:**
```
Socket not connected, attempting to connect...
```

**4. aria-describedby warning:**
```
Warning: Missing `Description` or `aria-describedby={undefined}` for {DialogContent}
```

### × ×™×ª×•×— - Response Structure Mismatch

**×”×‘×¢×™×” ×”××¨×›×–×™×ª:** API ××—×–×™×¨ ××‘× ×” ×©×•× ×” ×××” ×©×”-Frontend ××¦×¤×”:

```javascript
// API returns:
{ success: true, data: [...users...], pagination: {...} }

// Frontend expected:
{ users: [...], total: ... }
```

### ×¤×ª×¨×•×Ÿ - Normalize Response in Services

**1. userService.searchUsers:**
```javascript
async searchUsers(params = {}) {
  const response = await apiClient.get('/users', { params });
  const result = response.data;
  return {
    users: result.data || result.users || [],
    total: result.pagination?.total || (result.data || []).length,
    pagination: result.pagination,
  };
},
```

**2. chatService.getChats:**
```javascript
async getChats(params = {}) {
  const response = await apiClient.get('/chats', { params });
  const result = response.data;
  const chats = result.chats || result.data || [];
  return {
    chats,
    total: result.pagination?.total || chats.length,
    pagination: result.pagination,
  };
},
```

**3. reportService.listReports:**
```javascript
async listReports(params = {}) {
  const response = await apiClient.get('/reports', { params });
  const result = response.data;
  return {
    reports: result.data || result.reports || [],
    total: result.pagination?.total || (result.data || []).length,
    pagination: result.pagination,
  };
},
```

**4. chatService.createOrGetChat - Fixed demo data:**
```javascript
// Changed from { success, data: { chat } } to { chat }
// Consistent with real API response
```

**5. UserBioDialog - aria-describedby:**
```jsx
<DialogContent className="sm:max-w-md" aria-describedby={undefined}>
```

### ×§×‘×¦×™× ×©×¢×•×“×›× ×•

| ×§×•×‘×¥ | ×©×™× ×•×™ |
|------|-------|
| `apps/web/src/api/services/userService.js:42-55` | Normalize searchUsers response |
| `apps/web/src/api/services/chatService.js:15-27` | Normalize getChats response |
| `apps/web/src/api/services/chatService.js:37-57` | Fix createOrGetChat structure |
| `apps/web/src/api/services/reportService.js:45-58` | Normalize listReports response |
| `apps/web/src/components/user/UserBioDialog.jsx:70` | Add aria-describedby |

### ×œ××™×“×”

1. **Consistent Response Structure**: ×›×œ ×”-API responses ×¦×¨×™×›×™× ×œ×”×™×•×ª ×¢×§×‘×™×™×
2. **Service Layer Normalization**: ×”-service layer ×¦×¨×™×š ×œ× ×¨××œ ××ª ×”-responses ×œ×¤×•×¨××˜ ××—×™×“
3. **Both formats support**: ×ª××™×›×” ×‘×©× ×™ ×”×¤×•×¨××˜×™× (`result.data || result.users`) ×œ×’××™×©×•×ª

---

## âœ… ISSUE-018: Date Format Mismatch ISO vs yyyy-MM-dd (6 ×¤×‘×¨×•××¨ 2026)

**×¡×˜×˜×•×¡:** âœ… ×ª×•×§×Ÿ
**×¡×•×’:** ğŸŸ¡ ×‘×™× ×•× ×™
**×ª××¨×™×š:** 6 ×¤×‘×¨×•××¨ 2026

### ×ª×™××•×¨ ×”×‘×¢×™×”
××–×”×¨×•×ª ×‘-Console ×¢×œ ×¤×•×¨××˜ ×ª××¨×™×š ×©×’×•×™:
```
The specified value '1990-01-01T00:00:00.000Z' does not conform to the required format, 'yyyy-MM-dd'
```

**× ×™×ª×•×—:**
- ×”-API ××—×–×™×¨ ×ª××¨×™×›×™× ×‘×¤×•×¨××˜ ISO ××œ× (`1990-01-01T00:00:00.000Z`)
- ×”-HTML date input ×“×•×¨×© ×¤×•×¨××˜ `yyyy-MM-dd`
- ×›×©× ×˜×¢× ×™× × ×ª×•× ×™ ×”××©×ª××© ×‘-Onboarding, ×”×ª××¨×™×š × ×©××¨ ×›-ISO ×•××›×©×™×œ ××ª ×”-input

### ×¤×ª×¨×•×Ÿ

**1. ×”×•×¡×¤×ª ×¤×•× ×§×¦×™×™×ª formatDateForInput:**
```javascript
function formatDateForInput(date) {
  if (!date) return '';

  // If already in yyyy-MM-dd format, return as-is
  if (typeof date === 'string' && /^\d{4}-\d{2}-\d{2}$/.test(date)) {
    return date;
  }

  const dateObj = typeof date === 'string' ? new Date(date) : date;
  if (isNaN(dateObj.getTime())) return '';

  return dateObj.toISOString().split('T')[0];
}
```

**2. ×©×™××•×© ×‘×¤×•× ×§×¦×™×” ×‘×¢×ª ×˜×¢×™× ×ª × ×ª×•× ×™ ×”××©×ª××©:**
```javascript
date_of_birth: formatDateForInput(authUser.date_of_birth) || prev.date_of_birth,
```

### ×§×‘×¦×™× ×©×¢×•×“×›× ×•

| ×§×•×‘×¥ | ×©×™× ×•×™ |
|------|-------|
| `apps/web/src/pages/Onboarding.jsx:13-34` | ×”×•×¡×¤×ª formatDateForInput |
| `apps/web/src/pages/Onboarding.jsx:127` | ×©×™××•×© ×‘×¤×•× ×§×¦×™×” |

---

## âœ… ISSUE-017: Token Refresh Race Condition (6 ×¤×‘×¨×•××¨ 2026)

**×¡×˜×˜×•×¡:** âœ… ×ª×•×§×Ÿ
**×¡×•×’:** ğŸ”´ ×§×¨×™×˜×™
**×ª××¨×™×š:** 6 ×¤×‘×¨×•××¨ 2026

### ×ª×™××•×¨ ×”×‘×¢×™×”
×©×’×™××•×ª 401 ×—×•×–×¨×•×ª ×‘×¢×ª ×©××™×¨×ª ×ª××•× ×•×ª ×•×”×¢×œ××ª ×¦×™×•×¨:
```
PATCH /api/v1/users/... 401 (Unauthorized)
POST /api/v1/uploads/drawing 401 (Unauthorized)
Error uploading main profile image: AxiosError: Request failed with status code 401
Error saving drawing. Please try again.
```

**Flow ××”×œ×•×’×™×:**
```
07:45:20.271Z - PATCH 401 (× ×›×©×œ)
07:45:20.304Z - refresh 200 (×”×¦×œ×™×—!)
07:45:20.314Z - PATCH 401 (× ×›×©×œ ×©×•×‘!)
```

**× ×™×ª×•×—:**
- ×”-refresh ××¦×œ×™×— ××‘×œ ×”-retry ×¢×“×™×™×Ÿ × ×›×©×œ
- ×”-API ××—×–×™×¨ response ×¢×˜×•×£: `{ success: true, data: { accessToken: "..." } }`
- ×”×§×•×“ × ×™×¡×” ×œ×§×¨×•× `response.data.accessToken` ×‘××§×•× `response.data.data.accessToken`
- ×”-token ×©× ×©××¨ ×”×™×” `undefined`!

### ×¤×ª×¨×•×Ÿ

**×ª×™×§×•×Ÿ ×‘-apiClient.js:**
```javascript
// BEFORE (×‘××’×™):
const { accessToken } = response.data;

// AFTER (×ª×§×™×Ÿ):
const responseData = response.data.data || response.data;
const accessToken = responseData.accessToken || responseData.access_token;

if (!accessToken) {
  console.error('[apiClient] Token refresh failed - no accessToken:', response.data);
  throw new Error('No access token in refresh response');
}

console.log('[apiClient] Token refreshed successfully');
```

### ×§×‘×¦×™× ×©×¢×•×“×›× ×•

| ×§×•×‘×¥ | ×©×™× ×•×™ |
|------|-------|
| `apps/web/src/api/client/apiClient.js:179-198` | ×ª×™×§×•×Ÿ destructuring ×©×œ accessToken |

### ×œ××™×“×”

1. **×‘×“×™×§×ª ××‘× ×” ×”-response**: ×ª××™×“ ×œ×‘×“×•×§ ××ª ×”××‘× ×” ×”××“×•×™×§ ×©×”-API ××—×–×™×¨
2. **Logging ×—×™×•× ×™**: ×”×”×•×¡×¤×” ×©×œ logs ×œ×¦×“ ×”-refresh ×”×™×™×ª×” ×§×¨×™×˜×™×ª ×œ×–×™×”×•×™ ×”×‘×¢×™×”
3. **Defensive coding**: ×˜×™×¤×•×œ ×‘×©×ª×™ ×”××•×¤×¦×™×•×ª (`response.data.accessToken` OR `response.data.data.accessToken`)

---

## âœ… ISSUE-013: Onboarding Save Error - /users/undefined/14 (6 ×¤×‘×¨×•××¨ 2026)

**×¡×˜×˜×•×¡:** âœ… ×ª×•×§×Ÿ
**×¡×•×’:** ğŸ”´ ×§×¨×™×˜×™
**×ª××¨×™×š:** 6 ×¤×‘×¨×•××¨ 2026

### ×ª×™××•×¨ ×”×‘×¢×™×”
×‘×©×œ×‘ 14 ×©×œ ×”-Onboarding, ×©××™×¨×ª × ×ª×•× ×™ ×”××©×ª××© × ×›×©×œ×ª ×¢×:
```
PATCH http://localhost:3000/api/v1/users/undefined/14 500 (Internal Server Error)
Error saving user data
```

**× ×™×ª×•×—:**
- `authUser.id` ×”×•× `undefined` - ××•×‘×™×™×§×˜ ×”××©×ª××© ×œ× ××›×™×œ ID ×ª×§×™×Ÿ
- ×”× ×ª×™×‘ `/users/undefined/14` ××•×–×¨ - ××§×•×¨ ×”-`/14` ×œ× ×‘×¨×•×¨ (×™×™×ª×›×Ÿ ×§×©×•×¨ ×œ-step=14)
- ×—×¡×¨×” validation ××§×™×¤×” ×œ×¤× ×™ ×§×¨×™××•×ª API

### ×¤×ª×¨×•×Ÿ (3 ×©×›×‘×•×ª ×”×’× ×”)

**1. validation ×‘-userService.js:**
```javascript
async updateUser(userId, data) {
  // ×‘×“×™×§×ª userId
  if (!userId || userId === 'undefined' || userId === 'null') {
    throw new Error('Invalid user ID: userId is required');
  }

  // ×‘×“×™×§×ª data
  if (typeof data !== 'object' || data === null) {
    throw new Error('Invalid data: must be an object');
  }

  const response = await apiClient.patch(`/users/${userId}`, data);
  return response.data;
}
```

**2. ×‘×“×™×§×” ××¤×•×¨×©×ª ×‘-Onboarding.jsx (handleNext):**
```javascript
if (!authUser.id) {
  console.error('authUser.id is undefined:', authUser);
  alert('User ID not found. Please log out and log in again.');
  return;
}
```

**3. ×‘×“×™×§×ª authUser?.id ×œ×¤× ×™ ×§×¨×™××•×ª API × ×•×¡×¤×•×ª:**
```javascript
if (isAuthenticated && authUser?.id) {
  await userService.updateUser(authUser.id, { ... });
}
```

### ×§×‘×¦×™× ×©×¢×•×“×›× ×•

| ×§×•×‘×¥ | ×©×™× ×•×™ |
|------|-------|
| `apps/web/src/api/services/userService.js:93-104` | validation ××§×™×¤×” ×‘-updateUser |
| `apps/web/src/api/services/userService.js:26-31` | validation ×‘-updateProfile |
| `apps/web/src/pages/Onboarding.jsx:127-132` | ×‘×“×™×§×ª authUser.id ×œ×¤× ×™ ×©××™×¨×” |
| `apps/web/src/pages/Onboarding.jsx:1087,1117` | authUser?.id ×‘××§×•× authUser |

### ×‘×“×™×§×•×ª ×©× ×•×¡×¤×•

| ×§×•×‘×¥ ×‘×“×™×§×” | ×›×™×¡×•×™ |
|------------|-------|
| `userService.test.js` | validation ×©×œ undefined/null userId |

### ×©×•×¨×© ×”×‘×¢×™×”
×”×‘×¢×™×” ×”×™× ×›× ×¨××” ×©×”-user object ××”-backend ×œ× ××›×™×œ `id` ××• ×©×”×•× ×œ× × ×˜×¢×Ÿ ×›×¨××•×™.
**×”××œ×¦×” ×œ××©×ª××©:** ×œ× ×§×•×ª localStorage ×•×œ×”×ª×—×‘×¨ ××—×“×©.

### ×—×§×™×¨×” × ×•×¡×¤×ª × ×“×¨×©×ª
- ××§×•×¨ ×”-`/14` ×‘× ×ª×™×‘ URL ×œ× ×‘×¨×•×¨ ×œ×—×œ×•×˜×™×Ÿ
- ×™×™×ª×›×Ÿ ×©×™×© ×§×•×¨×œ×¦×™×” ×¢× step=14 ×‘× ×ª×™×‘ ×”×“×£
- × ×•×¡×¤×• console.logs ×œ×—×§×™×¨×”

---

## âœ… ISSUE-014: Database Empty + Date Field Issues (6 ×¤×‘×¨×•××¨ 2026)

**×¡×˜×˜×•×¡:** âœ… ×ª×•×§×Ÿ
**×¡×•×’:** ğŸ”´ ×§×¨×™×˜×™
**×ª××¨×™×š:** 6 ×¤×‘×¨×•××¨ 2026

### ×ª×™××•×¨
6 ×‘×¢×™×•×ª ×©×–×•×”×• ××”×ª××•× ×•×ª:

1. **EditProfile 400 Error** - "Error updating profile"
2. **UserProfile likes/user 400 Error** - "Request failed with status code 400"
3. **PrivateChat Skeleton Loading** - ×“×£ ×œ×œ× ×ª×•×›×Ÿ
4. **Creation Page "Invalid Date"** - ×ª××¨×™×›×™× ×œ× ××•×¦×’×™×
5. **AdminUserManagement "No users found"** - ××™×Ÿ ××©×ª××©×™×
6. **AdminSystemSettings 403 Forbidden** - ××™×Ÿ ×’×™×©×” ×œ×“×•×—×•×ª

### × ×™×ª×•×— ×©×•×¨×© ×”×‘×¢×™×”

**×‘×¢×™×” ×¢×™×§×¨×™×ª: ××¡×“ × ×ª×•× ×™× ×¨×™×§**
×›×œ ×”×©×’×™××•×ª × ×‘×¢×• ××›×š ×©××¡×“ ×”× ×ª×•× ×™× ×”×™×” ×¨×™×§ - ×œ× ×”×•×¨×¥ seed data.

**×‘×¢×™×•×ª × ×•×¡×¤×•×ª:**
- **Invalid Date**: ×—×•×¡×¨ ×”×ª×××” ×‘×™×Ÿ ×©×“×•×ª - backend ××—×–×™×¨ `createdAt`, apiClient ×××™×¨ ×œ-`created_at`, ××‘×œ frontend ××¦×¤×” ×œ-`created_date`
- **403 Forbidden**: ×—×•×¡×¨ ××©×ª××© admin ×œ×‘×“×™×§×ª ×“×¤×™ × ×™×”×•×œ

### ×¤×ª×¨×•× ×•×ª ×©×™×•×©××•

#### 14.1: ×”×¨×¦×ª Seed Data
```bash
cd apps/api && npx prisma db seed
```

**×ª×•×¦××”:**
- 18 ××©×ª××©×™× (×›×•×œ×œ admin)
- 10 ××©×™××•×ª
- 11 ×”×™×©×’×™×
- 10 ×¦'××˜×™× ×¢× ×”×•×“×¢×•×ª
- 10 ×¡×˜×•×¨×™×–
- ~54 ×ª×’×•×‘×•×ª
- 14 ×œ×™×™×§×™×
- 16 ×¢×•×§×‘×™×
- ~16 ×”×ª×¨××•×ª

#### 14.2: ×”×•×¡×¤×ª Admin User ×œ×¡×™×“
```typescript
// apps/api/prisma/seed.ts
const adminUser = {
  id: 'admin-user-1',
  email: 'admin@bellor.app',
  firstName: 'Admin',
  lastName: 'User',
  isAdmin: true,
  isVerified: true,
};
```

#### 14.3: ×ª×™×§×•×Ÿ Invalid Date - ×”×•×¡×¤×ª Field Aliases
```javascript
// apps/web/src/api/client/apiClient.js
const fieldAliases = {
  'created_at': 'created_date',
  'updated_at': 'updated_date',
  'last_active_at': 'last_active_date',
  'birth_date': 'date_of_birth',
};

function transformKeysToSnakeCase(obj) {
  // ... existing code ...
  // Add field aliases for backward compatibility
  if (fieldAliases[snakeKey]) {
    transformed[fieldAliases[snakeKey]] = transformed[snakeKey];
  }
}
```

#### 14.4: ×ª×™×§×•×Ÿ Creation.jsx - Fallback ×œ×ª××¨×™×š
```jsx
// apps/web/src/pages/Creation.jsx:190
{(response.created_date || response.createdAt)
  ? new Date(response.created_date || response.createdAt).toLocaleDateString('he-IL')
  : ''}
```

### ×§×‘×¦×™× ×©×¢×•×“×›× ×•

| ×§×•×‘×¥ | ×©×™× ×•×™ |
|------|-------|
| `apps/api/prisma/seed.ts` | ×”×•×¡×¤×ª admin user ×¢× isAdmin: true |
| `apps/web/src/api/client/apiClient.js` | ×”×•×¡×¤×ª field aliases |
| `apps/web/src/pages/Creation.jsx` | ×ª×™×§×•×Ÿ Invalid Date |

### ×¤×¨×˜×™ ×”×ª×—×‘×¨×•×ª ×œ×‘×“×™×§×”

| ×¡×•×’ | ××™××™×™×œ | ×¡×™×¡××” |
|-----|--------|--------|
| **Admin** | admin@bellor.app | Demo123! |
| **Demo User** | demo_sarah_special@bellor.app | Demo123! |
| **Demo User** | demo_maya@bellor.app | Demo123! |

### ×‘×“×™×§×”

×œ××—×¨ ×”×¨×¦×ª ×”-seed:
1. âœ… AdminUserManagement - ××¦×™×’ 18 ××©×ª××©×™×
2. âœ… EditProfile - ×¢×•×‘×“ (××—×¨×™ login)
3. âœ… UserProfile likes - ×¢×•×‘×“ (×™×© ××©×ª××©×™× ×‘-DB)
4. âœ… Creation page - ××¦×™×’ ×ª××¨×™×›×™× ×ª×§×™× ×™×
5. âœ… Admin pages - × ×’×™×©×™× ×¢× admin@bellor.app

---

## âœ… ISSUE-015: TemporaryChats - BIO Not Showing on Avatar Click (6 ×¤×‘×¨×•××¨ 2026)

**×¡×˜×˜×•×¡:** âœ… ×ª×•×§×Ÿ
**×¡×•×’:** ğŸŸ¡ ×‘×™× ×•× ×™ (UX)
**×ª××¨×™×š:** 6 ×¤×‘×¨×•××¨ 2026

### ×ª×™××•×¨ ×”×‘×¢×™×”
×‘×“×£ TemporaryChats, ×œ×—×™×¦×” ×¢×œ ××•×•×˜×¨/×ª××•× ×” ×©×œ ××©×ª××© ×œ× ××¦×™×’×” ××ª ×”-BIO ×©×œ×•.
×”×¦×™×¤×™×™×”: ×œ×—×™×¦×” ×¢×œ ×”×ª××•× ×” ×ª×¤×ª×— dialog ×¢× ××™×“×¢ ×¢×œ ×”××©×ª××©.
×”××¦×‘: ×›×œ ×”×›×¨×˜×™×¡ × ×™×ª×Ÿ ×œ×œ×—×™×¦×” ×•×× ×•×•×˜ ×™×©×™×¨×•×ª ×œ-PrivateChat.

### ×¤×ª×¨×•×Ÿ

#### 1. ×™×¦×™×¨×ª ×§×•××¤×•× × ×˜×ª UserBioDialog
```jsx
// apps/web/src/components/user/UserBioDialog.jsx
- ××¦×™×’ ××•×•×˜×¨, ×©×, ×’×™×œ, ××™×§×•×, ×•-BIO
- ×›×¤×ª×•×¨×™ "View Profile" ×•-"Chat"
- ×ª×•××š ×‘-demo users
- ×˜×¢×™× ×” ××¡×™× ×›×¨×•× ×™×ª ×©×œ × ×ª×•× ×™ ××©×ª××©
```

#### 2. ×¢×“×›×•×Ÿ TemporaryChats.jsx
```jsx
// ×”×¤×¨×“×ª ×œ×—×™×¦×” ×¢×œ ××•×•×˜×¨ ××œ×—×™×¦×” ×¢×œ ×›×¨×˜×™×¡
<button onClick={(e) => handleAvatarClick(e, userId, userName, userImage, chatId)}>
  <Avatar>...</Avatar>
</button>
```

### ×§×‘×¦×™× ×©× ×•×¡×¤×•/×¢×•×“×›× ×•

| ×§×•×‘×¥ | ×©×™× ×•×™ |
|------|-------|
| `apps/web/src/components/user/UserBioDialog.jsx` | **×—×“×©** - ×§×•××¤×•× × ×˜×ª dialog |
| `apps/web/src/pages/TemporaryChats.jsx` | ×©×™×œ×•×‘ UserBioDialog |
| `apps/web/e2e/temporary-chats-bio.spec.ts` | **×—×“×©** - E2E tests |

### ×‘×“×™×§×•×ª ×©× ×•×¡×¤×•

| ×§×•×‘×¥ ×‘×“×™×§×” | ×›×™×¡×•×™ |
|------------|-------|
| `e2e/temporary-chats-bio.spec.ts` | 7 tests - ×¤×ª×™×—×ª dialog, × ×™×•×•×˜ ×œ×¤×¨×•×¤×™×œ, × ×™×•×•×˜ ×œ×¦'××˜, ×¡×’×™×¨×” |

---

## âœ… ISSUE-016: Date Validation Defense in Depth (6 ×¤×‘×¨×•××¨ 2026)

**×¡×˜×˜×•×¡:** âœ… ×ª×•×§×Ÿ
**×¡×•×’:** ğŸ”´ ×§×¨×™×˜×™ (Recurring Bug)
**×ª××¨×™×š:** 6 ×¤×‘×¨×•××¨ 2026

### ×ª×™××•×¨ ×”×‘×¢×™×”
×‘××’ ×—×•×–×¨: ×©×’×™××ª 500 ×‘-Onboarding ×‘×’×œ×œ ×ª××¨×™×š ×œ×™×“×” ×œ× ×ª×§×™×Ÿ.
```
âš ï¸ "The specified value '1990-01-' does not conform to the required format 'yyyy-MM-dd'"
âŒ PATCH /api/v1/users/... 500 (Internal Server Error)
```

### × ×™×ª×•×— ×©×•×¨×© ×”×‘×¢×™×”

×©×¨×©×¨×ª ×›×©×œ ×‘-5 ×©×›×‘×•×ª:
| ×©×›×‘×” | ××™×§×•× | ×‘×¢×™×” |
|------|-------|------|
| 1 | HTML Date Input | ×××¤×©×¨ ×œ×›×ª×•×‘ ×ª××¨×™×š ×—×œ×§×™ |
| 2 | Onboarding.jsx | ××™×Ÿ validation |
| 3 | users.controller.ts | Zod ××§×‘×œ ×›×œ string |
| 4 | users.service.ts | `new Date()` ×¢×œ×•×œ ×œ×”×™×›×©×œ |
| 5 | Prisma | × ×–×¨×§×ª exception |

### ×¤×ª×¨×•×Ÿ - Defense in Depth

#### ×©×›×‘×” 1: Frontend Validation (Onboarding.jsx)
```javascript
function validateDateOfBirth(dateStr) {
  const dateRegex = /^\d{4}-\d{2}-\d{2}$/;
  if (!dateRegex.test(dateStr)) return { isValid: false, error: 'Invalid format' };
  // ... year range validation
}
```

#### ×©×›×‘×” 2: API Zod Validation (users.controller.ts)
```typescript
const dateStringSchema = z.string()
  .refine(val => /^\d{4}-\d{2}-\d{2}$/.test(val), 'Date must be yyyy-MM-dd')
  .refine(val => !isNaN(new Date(val).getTime()), 'Invalid date')
  .refine(val => year >= 1900 && year <= currentYear - 18, 'Must be 18+')
  .optional();
```

#### ×©×›×‘×” 3: Service Safe Parsing (users.service.ts)
```typescript
const parsedDate = validateAndParseDate(birthDateStr, 'birthDate');
if (parsedDate) {
  updateData.birthDate = parsedDate;
} else {
  logger.warn('birthDate validation failed, skipping field');
}
```

#### ×©×›×‘×” 4: ××¢×¨×›×ª ×œ×•×’×™× ××§×™×¤×”
```
apps/api/logs/
â”œâ”€â”€ app-*.log       # ×›×œ ×”×œ×•×’×™×
â”œâ”€â”€ requests-*.log  # HTTP requests
â”œâ”€â”€ errors-*.log    # Errors only
```

### ×§×‘×¦×™× ×©× ×•×¡×¤×•/×¢×•×“×›× ×•

| ×§×•×‘×¥ | ×©×™× ×•×™ |
|------|-------|
| `apps/api/src/lib/logger.ts` | **×—×“×©** - ××¢×¨×›×ª ×œ×•×’×™× |
| `apps/api/src/middleware/logging.middleware.ts` | **×—×“×©** - HTTP logging |
| `apps/api/src/controllers/users.controller.ts` | Zod validation + logging |
| `apps/api/src/services/users.service.ts` | Safe parsing + logging |
| `apps/web/src/pages/Onboarding.jsx` | Frontend validation |

### ×‘×“×™×§×•×ª ×©× ×•×¡×¤×•

| ×§×•×‘×¥ ×‘×“×™×§×” | ×›×™×¡×•×™ |
|------------|-------|
| `apps/api/src/lib/logger.test.ts` | Unit tests ×œdate validation |
| `apps/api/src/test/integration/users-date-validation.test.ts` | Integration tests |
| `apps/web/e2e/onboarding-date-validation.spec.ts` | E2E tests |

### ×× ×™×¢×ª ×—×–×¨×ª ×”×‘××’

1. **4 ×©×›×‘×•×ª ×”×’× ×”** - ×›×œ ×ª××¨×™×š ×¢×•×‘×¨ 4 validations
2. **×œ×•×’×™× ××¤×•×¨×˜×™×** - ×›×œ ×©×’×™××” ××ª×•×¢×“×ª ×¢× context ××œ×
3. **×‘×“×™×§×•×ª ××•×˜×•××˜×™×•×ª** - 20+ tests ×œ×ª××¨×™×›×™×

---

## âœ… AUDIT-001: API Validation Hardening (6 ×¤×‘×¨×•××¨ 2026)

**×¡×˜×˜×•×¡:** âœ… ×”×•×©×œ×
**×¡×•×’:** ğŸŸ¢ ×©×™×¤×•×¨ ××‘×˜×—×”
**×ª××¨×™×š:** 6 ×¤×‘×¨×•××¨ 2026

### ×ª×™××•×¨
×‘×¢×§×‘×•×ª ISSUE-013 (Onboarding Save Error with `/users/undefined/14`), ×‘×•×¦×¢ ×‘×™×§×•×¨×ª ××§×™×¤×” ×©×œ ×›×œ ×”×§×•×“ ×œ×–×™×”×•×™ ×•×ª×™×§×•×Ÿ ×‘×¢×™×•×ª ×“×•××•×ª ×©×œ undefined ID ×‘×§×¨×™××•×ª API.

### ×¡×™×›×•× ×”×‘×™×§×•×¨×ª

**×©×œ×‘ 1: ×¡×¨×™×§×ª Pages (23 ×§×‘×¦×™×)**
× ×¡×¨×§×• ×›×œ ×”×“×¤×™× ×©××©×ª××©×™× ×‘-`currentUser.id` ××• `authUser.id`:

| ×§×˜×’×•×¨×™×” | ×§×‘×¦×™× | ×¡×˜×˜×•×¡ |
|----------|--------|--------|
| Admin Pages | 6 | âœ… ×™×© validation ×‘×¨××ª ×”×“×£ |
| User Pages | 8 | âœ… ×™×© validation ×‘×¨××ª ×”×“×£ |
| Social Pages | 5 | âœ… ×™×© validation ×‘×¨××ª ×”×“×£ |
| Task Pages | 4 | âœ… ×™×© validation ×‘×¨××ª ×”×“×£ |

**×××¦×:** ×›×œ ×”×“×¤×™× ×›×•×œ×œ×™× ×‘×“×™×§×•×ª ×›××•:
```javascript
if (!authUser?.id) { navigate('/login'); return; }
if (!currentUser?.id) { return <LoadingState />; }
```

**×©×œ×‘ 2: ×™×¦×™×¨×ª ×©×›×‘×ª ×”×’× ×” × ×•×¡×¤×ª ×‘-API Services**
×œ××¨×•×ª ×©×”×“×¤×™× ××•×’× ×™×, × ×•×¡×¤×” ×©×›×‘×ª validation ××¨×›×–×™×ª ×‘-API services ×›-"defense in depth".

### ×§×•×‘×¥ ×—×“×©: validation.js

**××™×§×•×:** `apps/web/src/api/utils/validation.js`

```javascript
/**
 * Centralized API validation utilities
 * Defense-in-depth layer to catch undefined IDs before they reach the API
 */

export function validateUserId(userId, callerName = 'API call') {
  if (!userId) {
    console.error(`${callerName} called with invalid userId:`, userId);
    throw new Error(`Invalid user ID: userId is required for ${callerName}`);
  }
  if (userId === 'undefined' || userId === 'null') {
    console.error(`${callerName} called with string "${userId}"`);
    throw new Error(`Invalid user ID: "${userId}" is not valid for ${callerName}`);
  }
  if (typeof userId !== 'string') {
    console.error(`${callerName} called with non-string userId:`, typeof userId);
    throw new Error(`Invalid user ID: expected string, got ${typeof userId}`);
  }
}

export function validateRequiredId(id, paramName, callerName = 'API call') {
  if (!id) {
    console.error(`${callerName} called with invalid ${paramName}:`, id);
    throw new Error(`Invalid ${paramName}: required for ${callerName}`);
  }
  if (id === 'undefined' || id === 'null') {
    console.error(`${callerName} called with string "${id}" for ${paramName}`);
    throw new Error(`Invalid ${paramName}: "${id}" is not valid`);
  }
}

export function validateDataObject(data, callerName = 'API call') {
  if (typeof data !== 'object' || data === null) {
    console.error(`${callerName} called with invalid data:`, data);
    throw new Error(`Invalid data: must be an object for ${callerName}`);
  }
}
```

### Services ×©×¢×•×“×›× ×• (8 ×§×‘×¦×™×)

| Service | ×¤×•× ×§×¦×™×•×ª ×©×”×ª×•×•×¡×¤×” ×‘×”×Ÿ validation |
|---------|----------------------------------|
| `userService.js` | getUserById, updateUser, updateProfile, deleteUser, getUserSettings, updateUserSettings |
| `chatService.js` | getChatById, createOrGetChat, getChatMessages, sendMessage, markMessageAsRead, deleteMessage |
| `followService.js` | followUser, unfollowUser, checkFollowing, getFollowers, getFollowing |
| `likeService.js` | likeUser, unlikeUser, likeResponse, unlikeResponse, checkLiked, getResponseLikes |
| `storyService.js` | getStoriesByUser, getStoryById, viewStory, deleteStory, createStory |
| `reportService.js` | createReport, getReportsForUser, getReportById, reviewReport |
| `responseService.js` | getUserResponses, getResponseById, createResponse, likeResponse, deleteResponse |
| `notificationService.js` | markAsRead, deleteNotification |

### ×“×•×’××” ×œ×©×™××•×©

```javascript
// apps/web/src/api/services/userService.js
import { validateUserId, validateDataObject } from '../utils/validation';

export const userService = {
  async getUserById(userId) {
    validateUserId(userId, 'getUserById');  // throws if invalid
    const response = await apiClient.get(`/users/${userId}`);
    return { user: response.data?.data || response.data };
  },

  async updateUser(userId, data) {
    validateUserId(userId, 'updateUser');
    validateDataObject(data, 'updateUser');
    const response = await apiClient.patch(`/users/${userId}`, data);
    return response.data;
  },
};
```

### ×™×ª×¨×•× ×•×ª ×”×’×™×©×”

1. **Defense in Depth** - ×’× ×× ×‘×“×™×§×ª ×”×“×£ × ×›×©×œ×ª, ×”-service ×™×ª×¤×•×¡ ××ª ×”×©×’×™××”
2. **Console Logging** - ×”×•×“×¢×•×ª ×©×’×™××” ××¤×•×¨×˜×•×ª ×œ×“×™×‘×•×’
3. **Error Messages** - ×”×•×“×¢×•×ª ×‘×¨×•×¨×•×ª ×©×›×•×œ×œ×•×ª ××ª ×©× ×”×¤×•× ×§×¦×™×”
4. **Type Safety** - ×‘×“×™×§×ª ×¡×•×’ (string) ×œ××–×”×™×
5. **String Literals** - ×ª×¤×™×¡×ª ××§×¨×™× ×©×œ `"undefined"` ×•-`"null"` ×›××—×¨×•×–×•×ª

### ×‘×“×™×§×•×ª ×©× ×•×¡×¤×•

| ×§×•×‘×¥ ×‘×“×™×§×” | ×›×™×¡×•×™ |
|------------|-------|
| `apps/web/src/api/utils/validation.test.js` | validateUserId, validateRequiredId, validateDataObject |
| `apps/web/src/api/services/userService.test.js` | validation tests for undefined/null userId |

### ×× ×™×¢×ª ×—×–×¨×ª ×”×‘×¢×™×”

**×”× ×—×™×•×ª ×©× ×•×¡×¤×• ×œ-CLAUDE.md:**

```markdown
## ğŸ”´ ×ª×™×¢×•×“ ×‘××’×™× ×•×‘×“×™×§×•×ª - CRITICAL / MANDATORY

×œ××—×¨ ×›×œ ×ª×™×§×•×Ÿ ×‘××’:
| ×©×œ×‘ | ×¤×¢×•×œ×” | ×§×•×‘×¥ |
|-----|-------|------|
| 1 | ×ª×¢×“ ××ª ×”×‘××’ ×‘-OPEN_ISSUES.md | docs/OPEN_ISSUES.md |
| 2 | ×”×•×¡×£ ×‘×“×™×§×” ×©××›×¡×” ××ª ×”×‘××’ | apps/*/tests/ |
| 3 | ×•×•×“× ×©×”×‘×“×™×§×” ×¢×•×‘×¨×ª | npm test |
| 4 | ×¢×“×›×Ÿ ×¡×™×›×•× ×‘×˜×‘×œ×” | docs/OPEN_ISSUES.md |

âš ï¸ ×”× ×—×™×•×ª validation ×œ-API calls:
- ×ª××™×“ ×”×©×ª××© ×‘-validation utilities ×œ×¤× ×™ ×§×¨×™××•×ª API
- ×›×œ ×¤×•× ×§×¦×™×” ×©××§×‘×œ×ª userId ×—×™×™×‘×ª ×œ×§×¨×•× ×œ-validateUserId
- ×›×œ ×¤×•× ×§×¦×™×” ×©××§×‘×œ×ª ID ××—×¨ ×—×™×™×‘×ª ×œ×§×¨×•× ×œ-validateRequiredId
```

---

## âœ… ISSUE-012: CORS/Chat/Location Errors (6 ×¤×‘×¨×•××¨ 2026)

**×¡×˜×˜×•×¡:** âœ… ×ª×•×§×Ÿ
**×¡×•×’:** ğŸ”´ ×§×¨×™×˜×™
**×ª××¨×™×š:** 6 ×¤×‘×¨×•××¨ 2026

### ×ª×™××•×¨
4 ×‘××’×™× ×—×•×–×¨×™× ×©×–×•×”×• ×‘×‘×“×™×§×ª ×”××¤×œ×™×§×¦×™×”:

### 12.1: CORS Error - ERR_BLOCKED_BY_RESPONSE.NotSameOrigin

**×§×•×‘×¥ ××•×©×¤×¢:** `apps/api/src/config/security.config.ts:239`

**×ª×™××•×¨ ×”×‘×¢×™×”:**
×”×ª××•× ×•×ª ×‘×¢××•×“ `/Onboarding?step=8` × ×—×¡××• ×¢× ×©×’×™××ª CORS. ×”×¡×™×‘×”: ×§×•× ×¤×œ×™×§×˜ ×‘×™×Ÿ ×”×’×“×¨×•×ª headers.
- `app.ts:54` ×”×’×“×™×¨ `crossOriginResourcePolicy: { policy: 'cross-origin' }`
- `security.config.ts:239` ×“×¨×¡ ××ª ×”×”×’×“×¨×” ×¢× `'Cross-Origin-Resource-Policy': 'same-origin'`

**×¤×ª×¨×•×Ÿ:**
```typescript
// security.config.ts:239
// ×œ×¤× ×™:
'Cross-Origin-Resource-Policy': 'same-origin',
// ××—×¨×™:
'Cross-Origin-Resource-Policy': 'cross-origin',
```

### 12.2: Chat 400 Bad Request - otherUserId is required

**×§×‘×¦×™× ××•×©×¤×¢×™×:**
- `apps/web/src/components/feed/FeedPost.jsx:322-326`
- `apps/web/src/pages/SharedSpace.jsx:240`
- `apps/web/src/api/services/chatService.js:34`

**×ª×™××•×¨ ×”×‘×¢×™×”:**
×‘×§×©×ª ×¦'××˜ × ×›×©×œ×” ×¢× ×©×’×™××” 400 ×›×™ `response.user_id` ×”×™×” undefined.
- `FeedPost.jsx` ×§×¨× ×œ-`onChatRequest({ ...userData, id: response.user_id })`
- ×× `response.user_id` ×”×•× undefined, ×”-id ×©× ×©×œ×— ×”×•× undefined
- `SharedSpace.jsx` ×œ× ×ª×¤×¡ ××ª ×”××§×¨×” ×›×™ `chatRequestUser.id?.startsWith('demo-')` ××—×–×™×¨ undefined
- API × ×§×¨× ×¢× `otherUserId: undefined`

**×¤×ª×¨×•×Ÿ (3 ×©×›×‘×•×ª ×”×’× ×”):**
```javascript
// 1. FeedPost.jsx:322-326 - ×‘×“×™×§×” ×©-response.user_id ×§×™×™×
if (!chatRequestSent && onChatRequest && response.user_id) {
  onChatRequest({ ...userData, id: response.user_id });
}

// 2. SharedSpace.jsx:240 - ×‘×“×™×§×ª null
if (!chatRequestUser?.id || chatRequestUser.id.startsWith('demo-')) {
  console.log('Demo or invalid user - chat request simulated');
  return;
}

// 3. chatService.js:34 - validation
if (!otherUserId) {
  throw new Error('Invalid user ID: otherUserId is required');
}
```

### 12.3: Location Object Rendering Error

**×§×•×‘×¥ ××•×©×¤×¢:** `apps/web/src/pages/UserProfile.jsx:310`

**×ª×™××•×¨ ×”×‘×¢×™×”:**
×©×’×™××ª React: "Objects are not valid as a React child (found: object with keys {lat, lng, city, country})"
×”×©×“×” `viewedUser.location` ×”×•× ××•×‘×™×™×§×˜ ××”-database, ××‘×œ ×”×§×•×“ × ×™×¡×” ×œ×”×¦×™×’ ××•×ª×• ×›×˜×§×¡×˜ ×™×©×™×¨×•×ª.

**×¤×ª×¨×•×Ÿ:**
```jsx
// ×œ×¤× ×™:
<span>{viewedUser.location}</span>

// ××—×¨×™:
<span>{formatLocation(viewedUser.location)}</span>
```

### 12.4: Data Format Mismatch (nickname/age/location)

**×§×‘×¦×™× ××•×©×¤×¢×™×:**
- `apps/web/src/components/feed/FeedPost.jsx:184` - ×©×™××•×© ×‘-`userData.nickname` ×•-`userData.age`
- `apps/web/src/pages/UserProfile.jsx:310` - ×©×™××•×© ×‘-`viewedUser.location`

**×ª×™××•×¨ ×”×‘×¢×™×”:**
×—×•×¡×¨ ×”×ª×××” ×‘×™×Ÿ ×¤×•×¨××˜ ×”× ×ª×•× ×™× ××”-API ×œ×‘×™×Ÿ ××” ×©×”-Frontend ××¦×¤×” ×œ×•:
| DB (Prisma) | API Response | Frontend expects |
|-------------|--------------|------------------|
| firstName   | first_name   | nickname âŒ |
| birthDate   | birth_date   | age (NUMBER) âŒ |
| location    | location (object) | location (STRING) âŒ |

**×¤×ª×¨×•×Ÿ - ×™×¦×™×¨×ª User Transformer:**
```javascript
// apps/web/src/utils/userTransformer.js (×§×•×‘×¥ ×—×“×©)
export function calculateAge(birthDate) { ... }
export function formatLocation(location) { ... }
export function transformUser(user) {
  return {
    ...user,
    nickname: user.first_name || user.firstName || user.nickname,
    age: calculateAge(user.birth_date || user.birthDate),
    location_display: formatLocation(user.location),
  };
}
```

### ×§×‘×¦×™× ×©×¢×•×“×›× ×•

| ×§×•×‘×¥ | ×©×™× ×•×™ |
|------|-------|
| `apps/api/src/config/security.config.ts:239` | CORS: `'cross-origin'` |
| `apps/web/src/pages/SharedSpace.jsx:240` | ×‘×“×™×§×ª null ×œ-chatRequestUser.id |
| `apps/web/src/components/feed/FeedPost.jsx:322` | ×‘×“×™×§×ª response.user_id |
| `apps/web/src/api/services/chatService.js:34` | validation ×œ-otherUserId |
| `apps/web/src/utils/userTransformer.js` | **×—×“×©** - transformer ×œ× ×ª×•× ×™ ××©×ª××© |
| `apps/web/src/utils/index.ts` | ×™×™×¦×•× transformUser, formatLocation, calculateAge |
| `apps/web/src/pages/UserProfile.jsx:310` | ×©×™××•×© ×‘-formatLocation |
| `apps/web/src/components/feed/FeedPost.jsx:132` | ×©×™××•×© ×‘-transformUser |

### ×‘×“×™×§×•×ª ×©× ×•×¡×¤×•

| ×§×•×‘×¥ ×‘×“×™×§×” | ×›×™×¡×•×™ |
|------------|-------|
| `userTransformer.test.js` | calculateAge, formatLocation, transformUser |
| `chatService.test.js` | validation ×œ-otherUserId |
| `FeedPost.test.jsx` | defensive checks ×œ-undefined user_id |

### ×× ×™×¢×ª ×—×–×¨×ª ×”×‘××’×™×

1. **Centralized Transformers** - ×›×œ ×”×”××¨×•×ª ×‘-`userTransformer.js`
2. **Defensive Coding** - 3 ×©×›×‘×•×ª validation ×œ×›×œ API call
3. **Type Safety** (×”××œ×¦×” ×œ×¢×ª×™×“) - TypeScript interfaces ×œ-User

---

## âœ… TEST-003: Backend Tests Expansion (4 ×¤×‘×¨×•××¨ 2026)

**×¡×˜×˜×•×¡:** âœ… ×”×•×©×œ×
**×¡×•×’:** ğŸŸ¢ ×©×™×¤×•×¨
**×ª××¨×™×š:** 4 ×¤×‘×¨×•××¨ 2026

### ×ª×™××•×¨
×”×¨×—×‘×ª ×›×™×¡×•×™ ×‘×“×™×§×•×ª Backend ×œ-100% ×©×œ ×›×œ ×”-services.

### ×§×‘×¦×™ ×‘×“×™×§×•×ª ×—×“×©×™× (7 ×§×‘×¦×™×)

| ×§×•×‘×¥ | ××¡×¤×¨ ×‘×“×™×§×•×ª |
|------|-------------|
| `chat.service.test.ts` | 37 |
| `likes.service.test.ts` | 27 |
| `notifications.service.test.ts` | 22 |
| `achievements.service.test.ts` | 19 |
| `stories.service.test.ts` | 22 |
| `follows.service.test.ts` | 15 |
| `reports.service.test.ts` | 24 |

**×¡×”"×›:** 166 ×‘×“×™×§×•×ª ×—×“×©×•×ª

### ×©×™× ×•×™×™× × ×•×¡×¤×™×

| ×§×•×‘×¥ | ×©×™× ×•×™ |
|------|-------|
| `setup.ts` | ×”×•×¡×¤×ª mocks ×—×¡×¨×™× (findFirst, count, aggregate, etc.) |

---

## âœ… LINT-003: ESLint & Code Quality Fix (4 ×¤×‘×¨×•××¨ 2026)

**×¡×˜×˜×•×¡:** âœ… ×ª×•×§×Ÿ
**×¡×•×’:** ğŸŸ¡ ×‘×™× ×•× ×™
**×ª××¨×™×š:** 4 ×¤×‘×¨×•××¨ 2026

### ×ª×§×œ×•×ª ×©×ª×•×§× ×•

| ×ª×§×œ×” | ×§×•×‘×¥ | ×ª×™×§×•×Ÿ |
|------|------|-------|
| ESLint parsing error for test files | `eslint.config.js` | ×”×•×¡×¤×ª config × ×¤×¨×“ ×œ×§×‘×¦×™ test ×œ×œ× project requirement |
| `let` should be `const` | `admin.controller.ts` | ×©×™× ×•×™ `let updateData` ×œ-`const updateData` |
| Redundant double negation | `auth.service.ts` | ×©×™× ×•×™ `!!user.isBlocked` ×œ-`user.isBlocked` |

### ×§×‘×¦×™× ×©×¢×•×“×›× ×•

| ×§×•×‘×¥ | ×©×™× ×•×™ |
|------|-------|
| `apps/api/eslint.config.js` | ×”×•×¡×¤×ª config ×œ×§×‘×¦×™ test |
| `apps/api/src/controllers/admin.controller.ts` | `const` ×‘××§×•× `let` |
| `apps/api/src/services/auth.service.ts` | ×”×¡×¨×ª `!!` ××™×•×ª×¨ |

---

## âœ… TASK-001: Task Upload Errors Fix (4 ×¤×‘×¨×•××¨ 2026)

**×¡×˜×˜×•×¡:** âœ… ×ª×•×§×Ÿ
**×¡×•×’:** ğŸ”´ ×§×¨×™×˜×™
**×ª××¨×™×š:** 4 ×¤×‘×¨×•××¨ 2026

### ×ª×§×œ×•×ª ×©×ª×•×§× ×•

| ×ª×§×œ×” | ×§×•×‘×¥ | ×ª×™×§×•×Ÿ |
|------|------|-------|
| `PATCH /api/v1/users/[object Object] 403` | `AudioTask.jsx` | ×”×•×¡×£ `currentUser.id` ×›×¤×¨××˜×¨ ×¨××©×•×Ÿ ×œ-`updateProfile()` |
| `PATCH /api/v1/users/[object Object] 403` | `VideoTask.jsx` | ×”×•×¡×£ `currentUser.id` ×›×¤×¨××˜×¨ ×¨××©×•×Ÿ ×œ-`updateProfile()` |

### ×”×¡×‘×¨ ×”×‘×¢×™×”
×¤×•× ×§×¦×™×™×ª `userService.updateProfile(userId, data)` ××¦×¤×” ×œ×©× ×™ ×¤×¨××˜×¨×™×:
1. `userId` - ××—×¨×•×–×ª ×¢× ××–×”×” ×”××©×ª××©
2. `data` - ××•×‘×™×™×§×˜ ×¢× ×”× ×ª×•× ×™× ×œ×¢×“×›×•×Ÿ

×‘×§×•×“ ×”×™×©×Ÿ × ×©×œ×— ×¨×§ ××•×‘×™×™×§×˜ ×”× ×ª×•× ×™×, ××” ×©×’×¨× ×œ-URL ×œ×”×™×•×ª `/users/[object Object]`.

### ×§×‘×¦×™× ×©×¢×•×“×›× ×•

| ×§×•×‘×¥ | ×©×™× ×•×™ |
|------|-------|
| `apps/web/src/pages/AudioTask.jsx` | `updateProfile(currentUser.id, {...})` |
| `apps/web/src/pages/VideoTask.jsx` | `updateProfile(currentUser.id, {...})` |

### ×‘×“×™×§×•×ª ×©× ×•×¡×¤×•

| ×§×•×‘×¥ ×‘×“×™×§×” | ×›×™×¡×•×™ |
|------------|-------|
| `userService.test.js` | 9 ×‘×“×™×§×•×ª - ×•×™×“×•× ×¤×•×¨××˜ ×¤×¨××˜×¨×™× × ×›×•×Ÿ |

---

## âœ… CONSOLE-002: Console Errors Fix (4 ×¤×‘×¨×•××¨ 2026)

**×¡×˜×˜×•×¡:** âœ… ×ª×•×§×Ÿ
**×¡×•×’:** ğŸ”´ ×§×¨×™×˜×™
**×ª××¨×™×š:** 4 ×¤×‘×¨×•××¨ 2026

### ×ª×§×œ×•×ª ×©×ª×•×§× ×•

| ×ª×§×œ×” | ×§×•×‘×¥ | ×ª×™×§×•×Ÿ |
|------|------|-------|
| `POST /api/v1/chats 400 Bad Request` | `SharedSpace.jsx` | ×”×•×¡×£ ×‘×“×™×§×ª demo user ×œ×¤× ×™ ×§×¨×™××ª API |
| `TypeError: target must be an object` | `StarSendersModal.jsx` | ×©×™× ×•×™ `getResponseLikes(id, 'POSITIVE')` ×œ-`getResponseLikes(id, { likeType: 'POSITIVE' })` |
| `Cannot read properties of null (reading 'length')` | `StarSendersModal.jsx` | ×”×•×¡×£ ×‘×“×™×§×ª nullish: `!senders \|\| senders.length === 0` |
| `Warning: Missing "Description"` | `command.jsx` | ×”×•×¡×£ `aria-describedby` ×•-description element |

### ×§×‘×¦×™× ×©×¢×•×“×›× ×•

| ×§×•×‘×¥ | ×©×™× ×•×™ |
|------|-------|
| `apps/web/src/pages/SharedSpace.jsx` | ×‘×“×™×§×ª demo user ID ×œ×¤× ×™ ×™×¦×™×¨×ª chat |
| `apps/web/src/components/feed/StarSendersModal.jsx` | ×ª×™×§×•×Ÿ params ×œ-API + nullish check |
| `apps/web/src/components/ui/command.jsx` | ×”×•×¡×¤×ª aria-describedby ×œ× ×’×™×©×•×ª |

### ×‘×“×™×§×•×ª ×©× ×•×¡×¤×•

| ×§×•×‘×¥ ×‘×“×™×§×” | ×›×™×¡×•×™ |
|------------|-------|
| `likeService.test.js` | 9 ×‘×“×™×§×•×ª - ×¤×•×¨××˜ params ×œ×§×¨×™××•×ª API |
| `SharedSpace.test.jsx` | 6 ×‘×“×™×§×•×ª - ×˜×™×¤×•×œ ×‘-demo users |
| `StarSendersModal.test.jsx` | 10 ×‘×“×™×§×•×ª - nullish handling ×•-API format |

**×¡×”"×›:** 25 ×‘×“×™×§×•×ª ×—×“×©×•×ª

---

## âœ… POLISH-001: Reusable State Components (Loading, Empty, Error)

**×¡×˜×˜×•×¡:** âœ… ×”×•×©×œ×
**×¡×•×’:** ğŸŸ¢ ×©×™×¤×•×¨ UX
**×ª××¨×™×š:** 4 ×¤×‘×¨×•××¨ 2026

### ×ª×™××•×¨
× ×•×¦×¨×• ×¨×›×™×‘×™ state ×¢×–×¨ ×œ×©×™××•×© ×—×•×–×¨ ×‘×›×œ ×”×“×¤×™×:
- **LoadingState** - ××¦×‘×™ ×˜×¢×™× ×” ×¢× skeletons ××•×ª×××™×
- **EmptyState** - ××¦×‘×™× ×¨×™×§×™× ×¢× ××™×™×§×•× ×™× ×•-CTAs
- **ErrorState** - ×”×¦×’×ª ×©×’×™××•×ª ×¢× ××¤×©×¨×•×ª retry

### ×§×‘×¦×™× ×©× ×•×¦×¨×•

| ×§×•×‘×¥ | ×ª×™××•×¨ |
|------|-------|
| `apps/web/src/components/states/LoadingState.jsx` | ×¨×›×™×‘ ×˜×¢×™× ×” ×¢× ×•×¨×™×× ×˜×™×: spinner, skeleton, cards, list, profile, chat, feed, full |
| `apps/web/src/components/states/EmptyState.jsx` | ××¦×‘ ×¨×™×§ ×¢× ×•×¨×™×× ×˜×™×: messages, matches, feed, notifications, search, media, achievements |
| `apps/web/src/components/states/ErrorState.jsx` | ×”×¦×’×ª ×©×’×™××•×ª ×¢× ×•×¨×™×× ×˜×™×: default, network, server, notFound, unauthorized, forbidden |
| `apps/web/src/components/states/index.js` | ×™×™×¦×•× ××¨×•×›×– ×©×œ ×›×œ ×”×¨×›×™×‘×™× |

### ×“×¤×™× ×©×¢×•×“×›× ×• (40+ ×“×¤×™×)

#### Core Pages
| ×“×£ | Skeleton | EmptyState |
|----|----------|------------|
| `SharedSpace.jsx` | FeedSkeleton | âœ… feed |
| `Profile.jsx` | ProfileSkeleton | âœ… media |
| `Matches.jsx` | CardsSkeleton | âœ… matches |
| `Notifications.jsx` | ListSkeleton | âœ… notifications |
| `TemporaryChats.jsx` | ListSkeleton | âœ… messages |

#### Settings & User Pages
| ×“×£ | Skeleton | EmptyState |
|----|----------|------------|
| `Settings.jsx` | ListSkeleton | - |
| `FollowingList.jsx` | ListSkeleton | âœ… followers |
| `BlockedUsers.jsx` | ListSkeleton | âœ… default |
| `FilterSettings.jsx` | ListSkeleton | - |
| `ThemeSettings.jsx` | CardsSkeleton | - |
| `EditProfile.jsx` | ProfileSkeleton | - |
| `UserProfile.jsx` | ProfileSkeleton | - |

#### Social & Content Pages
| ×“×£ | Skeleton | EmptyState |
|----|----------|------------|
| `Stories.jsx` | CardsSkeleton | âœ… |
| `Achievements.jsx` | CardsSkeleton | - |
| `Discover.jsx` | CardsSkeleton | - |

#### Chat Pages
| ×“×£ | Skeleton | EmptyState |
|----|----------|------------|
| `PrivateChat.jsx` | ChatSkeleton | - |
| `LiveChat.jsx` | ChatSkeleton | - |

#### Task Pages
| ×“×£ | Skeleton | EmptyState |
|----|----------|------------|
| `AudioTask.jsx` | LoadingState spinner | - |
| `VideoTask.jsx` | LoadingState spinner | - |
| `CreateStory.jsx` | LoadingState spinner | - |
| `VideoDate.jsx` | LoadingState spinner | - |
| `CompatibilityQuiz.jsx` | LoadingState spinner | - |
| `UserVerification.jsx` | LoadingState spinner | - |

#### Premium & Support Pages
| ×“×£ | Skeleton | EmptyState |
|----|----------|------------|
| `Premium.jsx` | CardsSkeleton | - |
| `ReferralProgram.jsx` | CardsSkeleton | - |
| `ProfileBoost.jsx` | CardsSkeleton | - |
| `Analytics.jsx` | CardsSkeleton | - |
| `DateIdeas.jsx` | CardsSkeleton | âœ… |
| `IceBreakers.jsx` | ListSkeleton | âœ… |
| `VirtualEvents.jsx` | CardsSkeleton | - |
| `SafetyCenter.jsx` | CardsSkeleton | - |
| `Feedback.jsx` | CardsSkeleton | - |
| `EmailSupport.jsx` | CardsSkeleton | - |
| `FAQ.jsx` | ListSkeleton | âœ… |

#### Admin Pages
| ×“×£ | Skeleton | EmptyState |
|----|----------|------------|
| `AdminDashboard.jsx` | CardsSkeleton | âœ… notifications |
| `AdminUserManagement.jsx` | ListSkeleton | âœ… search |
| `AdminReportManagement.jsx` | ListSkeleton | âœ… notifications |
| `AdminChatMonitoring.jsx` | ListSkeleton | âœ… messages |
| `AdminActivityMonitoring.jsx` | ListSkeleton | âœ… followers |
| `AdminSystemSettings.jsx` | ListSkeleton | âœ… settings |
| `AdminPreRegistration.jsx` | ListSkeleton | âœ… followers |

### ×©×™××•×©

```jsx
// Loading states
import { LoadingState, FeedSkeleton, ProfileSkeleton, ListSkeleton } from '@/components/states';

// Empty states
import { EmptyState, NoMessages, NoMatches } from '@/components/states';

// Error states
import { ErrorState, NetworkError, ServerError } from '@/components/states';

// ×“×•×’××” ×œ×©×™××•×©
if (isLoading) {
  return <FeedSkeleton count={3} />;
}

if (data.length === 0) {
  return (
    <EmptyState
      variant="feed"
      title="No posts yet"
      actionLabel="Share now"
      onAction={() => openTaskSelector()}
    />
  );
}
```

### ×•×¨×™×× ×˜×™× ×–××™× ×™×

**LoadingState variants:**
- `spinner` - ×¡×¤×™× ×¨ ×¤×©×•×˜
- `skeleton` - ×©×•×¨×•×ª skeleton
- `cards` - ×¨×©×ª ×›×¨×˜×™×¡×™×
- `list` - ×¨×©×™××”
- `profile` - skeleton ×œ×¤×¨×•×¤×™×œ
- `chat` - skeleton ×œ×”×•×“×¢×•×ª
- `feed` - skeleton ×œ×¤×™×“
- `full` - ×˜×¢×™× ×ª ×“×£ ××œ×

**EmptyState variants:**
- `default`, `messages`, `matches`, `feed`, `notifications`, `search`
- `followers`, `following`, `media`, `photos`, `videos`, `audio`
- `events`, `achievements`, `premium`, `bookmarks`

**ErrorState variants:**
- `default`, `network`, `server`, `notFound`, `unauthorized`, `forbidden`

---

## âœ… E2E-001: Playwright E2E Tests Expansion

**×¡×˜×˜×•×¡:** âœ… ×”×•×©×œ×
**×¡×•×’:** ğŸŸ¢ ×©×™×¤×•×¨ QA
**×ª××¨×™×š:** 4 ×¤×‘×¨×•××¨ 2026

### ×ª×™××•×¨
×”×¨×—×‘×ª ×›×™×¡×•×™ ×‘×“×™×§×•×ª E2E ×¢× Playwright - × ×•×¡×¤×• 7 ×§×‘×¦×™ ×‘×“×™×§×” ×—×“×©×™×.

### ×§×‘×¦×™× ×©× ×•×¦×¨×•

| ×§×•×‘×¥ | ×‘×“×™×§×•×ª | ×ª×™××•×¨ |
|------|--------|-------|
| `e2e/feed.spec.ts` | ~30 | Feed & SharedSpace - daily mission, responses, likes |
| `e2e/chat.spec.ts` | ~25 | Chat & Messaging - messages, typing, history |
| `e2e/profile.spec.ts` | ~25 | Profile Management - view, edit, my book |
| `e2e/matches.spec.ts` | ~20 | Matches & Likes - romantic, positive, interactions |
| `e2e/onboarding.spec.ts` | ~30 | Full 14-step Onboarding flow |
| `e2e/notifications.spec.ts` | ~20 | Notifications - list, mark read, navigate |
| `e2e/settings.spec.ts` | ~25 | Settings - theme, privacy, blocked, following |

### ×§×‘×¦×™× ×§×™×™××™× (×¢×•×“×›× ×•)

| ×§×•×‘×¥ | ×ª×™××•×¨ |
|------|-------|
| `e2e/fixtures.ts` | ×”×•×¡×¤×ª ~30 helper functions ×—×“×©×•×ª |
| `e2e/auth.spec.ts` | ×‘×“×™×§×•×ª ××™××•×ª (×§×™×™×) |
| `e2e/navigation.spec.ts` | ×‘×“×™×§×•×ª × ×™×•×•×˜ (×§×™×™×) |
| `e2e/api-client.spec.ts` | ×‘×“×™×§×•×ª API client (×§×™×™×) |
| `e2e/onboarding-drawing.spec.ts` | ×‘×“×™×§×•×ª ×¦×™×•×¨ (×§×™×™×) |

### ×¡×™×›×•×

- **×¡×”"×› ×§×‘×¦×™ ×‘×“×™×§×”:** 11
- **×¡×”"×› ×‘×“×™×§×•×ª (Chromium):** ~224
- **×“×¤×“×¤× ×™× × ×ª××›×™×:** Chrome, Mobile Chrome, Mobile Safari, Firefox (CI)

### ×¤×§×•×“×•×ª ×”×¨×¦×”

```bash
npm run test:e2e           # ×”×¨×¦×ª ×›×œ ×”×‘×“×™×§×•×ª
npm run test:e2e:ui        # ×××©×§ ×’×¨×¤×™
npm run test:e2e:headed    # ×¢× ×“×¤×“×¤×Ÿ ×¤×ª×•×—
npm run test:e2e:report    # ×“×•×— ×ª×•×¦××•×ª
```

---

## âœ… ×ª×§×œ×•×ª ×©×ª×•×§× ×• ×œ××—×¨×•× ×”

### ISSUE-011: Upload Routing Issues - Wrong Endpoints Used (4 ×ª×§×œ×•×ª)

**×¡×˜×˜×•×¡:** âœ… ×ª×•×§×Ÿ
**×—×•××¨×”:** ğŸ”´ ×§×¨×™×˜×™
**×ª××¨×™×š ×–×™×”×•×™:** 4 ×¤×‘×¨×•××¨ 2026
**×ª××¨×™×š ×ª×™×§×•×Ÿ:** 4 ×¤×‘×¨×•××¨ 2026

#### ×ª×™××•×¨ ×”×‘×¢×™×”
××¡×¤×¨ ×“×¤×™× ×”×©×ª××©×• ×‘-`uploadService.uploadFile()` ×‘××•×¤×Ÿ ×’× ×¨×™, ××” ×©×’×¨× ×œ× ×™×ª×•×‘ ×©×’×•×™ ×©×œ ×§×‘×¦×™×:

1. **VideoTask.jsx** - ×•×™×“××• × ×©×œ×— ×œ-`/uploads/profile-image` ×‘××§×•× `/uploads/video` â†’ ×©×’×™××ª 400
2. **AudioTask.jsx** - ××•×“×™×• ×œ× × ×•×ª×‘ ×œ-endpoint ×”× ×›×•×Ÿ
3. **EditProfile.jsx** - ×ª××•× ×•×ª ×¤×¨×•×¤×™×œ × ×©×œ×—×• ×œ-`/uploads/response-media` ×‘××§×•× `/uploads/profile-image`
4. **CreateStory.jsx** - ×ª××•× ×•×ª ×¡×˜×•×¨×™ × ×©×œ×—×• ×œ-`/uploads/response-media` ×‘××§×•× `/uploads/story-media`

#### ×§×‘×¦×™ Backend ×©× ×•×¦×¨×• âœ…

| ×§×•×‘×¥ | ×©×•×¨×” | ×ª×™×§×•×Ÿ |
|------|------|-------|
| `apps/api/src/routes/v1/uploads.routes.ts` | 314-367 | × ×•×¡×£ endpoint `/uploads/video` ×œ×˜×™×¤×•×œ ×‘×§×‘×¦×™ ×•×™×“××• |
| `apps/api/src/routes/v1/uploads.routes.ts` | 369-423 | × ×•×¡×£ endpoint `/uploads/response-media` ×œ×˜×™×¤×•×œ ×‘××“×™×” ×©×œ ×ª×’×•×‘×•×ª |

#### ×§×‘×¦×™ Frontend ×©×ª×•×§× ×• âœ…

| ×§×•×‘×¥ | ×©×•×¨×” | ×ª×™×§×•×Ÿ |
|------|------|-------|
| `apps/web/src/api/services/uploadService.js` | 68-79 | × ×•×¡×¤×” ×¤×•× ×§×¦×™×™×ª `uploadVideo()` |
| `apps/web/src/api/services/uploadService.js` | 119-130 | × ×•×¡×¤×” ×¤×•× ×§×¦×™×™×ª `uploadResponseMedia()` |
| `apps/web/src/api/services/uploadService.js` | 138-159 | ×¢×•×“×›× ×” `uploadFile()` ×œ× ×ª×‘ ×•×™×“××•, ××•×“×™×• ×•×ª××•× ×•×ª ×œendpoints ×”× ×›×•× ×™× |
| `apps/web/src/pages/EditProfile.jsx` | 90 | ×©×•× ×” ×-`uploadFile()` ×œ-`uploadProfileImage()` |
| `apps/web/src/pages/CreateStory.jsx` | 66 | ×©×•× ×” ×-`uploadFile()` ×œ-`uploadStoryMedia()` |

#### ×¤×™×¨×•×˜ ×ª×™×§×•× ×™×

**11.1: uploadService - Video Upload Support**

```javascript
// apps/web/src/api/services/uploadService.js
async uploadVideo(file) {
  const formData = new FormData();
  formData.append('file', file);
  const response = await apiClient.post('/uploads/video', formData, {
    headers: { 'Content-Type': 'multipart/form-data' },
  });
  return response.data.data || response.data;
},
```

**11.2: uploadService - Smart Routing in uploadFile**

```javascript
async uploadFile(file) {
  const isImage = file.type.startsWith('image/');
  const isAudio = file.type.startsWith('audio/');
  const isVideo = file.type.startsWith('video/');

  let result;
  if (isVideo) {
    result = await this.uploadVideo(file);
  } else if (isAudio) {
    result = await this.uploadAudio(file);
  } else if (isImage) {
    result = await this.uploadResponseMedia(file);
  } else {
    result = await this.uploadResponseMedia(file);
  }
  return { url: result.url };
},
```

**11.3: EditProfile - Use Specific Profile Image Upload**

```javascript
// Before:
const { file_url } = await uploadService.uploadFile(file);

// After:
const result = await uploadService.uploadProfileImage(file);
```

**11.4: CreateStory - Use Specific Story Media Upload**

```javascript
// Before:
const uploadResult = await uploadService.uploadFile(file);

// After:
const uploadResult = await uploadService.uploadStoryMedia(file);
```

---

### ISSUE-010: Console Errors - Multiple API & Accessibility Issues (4 ×ª×§×œ×•×ª)

**×¡×˜×˜×•×¡:** âœ… ×ª×•×§×Ÿ
**×—×•××¨×”:** ğŸ”´ ×§×¨×™×˜×™
**×ª××¨×™×š ×–×™×”×•×™:** 4 ×¤×‘×¨×•××¨ 2026
**×ª××¨×™×š ×ª×™×§×•×Ÿ:** 4 ×¤×‘×¨×•××¨ 2026

#### ×ª×™××•×¨ ×”×‘×¢×™×”
××¡×¤×¨ ×©×’×™××•×ª ×‘×§×•× ×¡×•×œ ×©×–×•×”×• ×‘×–××Ÿ ×¨×™×¦×ª ×”××¤×œ×™×§×¦×™×”:

1. **GET/POST /api/v1/chats 404 (Not Found)** - × ×ª×™×‘×™ chat ×œ× ×”×™×• ×§×™×™××™× ×‘×›×œ×œ ×‘-API
2. **responseService.getUserResponses is not a function** - ×¤×•× ×§×¦×™×” ×—×¡×¨×”
3. **Socket connection error: Invalid namespace** - ×›×ª×•×‘×ª WebSocket ×©×’×•×™×”
4. **Missing DialogDescription aria-describedby warnings** - ×‘×¢×™×•×ª × ×’×™×©×•×ª

#### ×§×‘×¦×™× ×©× ×•×¦×¨×• âœ…

| ×§×•×‘×¥ | ×ª×™××•×¨ |
|------|-------|
| `apps/api/src/services/chat.service.ts` | ×©×™×¨×•×ª chat ×—×“×© ×¢× getUserChats, getChatById, createOrGetChat, getMessages, sendMessage, markMessageAsRead, deleteMessage |
| `apps/api/src/routes/v1/chats.routes.ts` | × ×ª×™×‘×™ API ×œ-chat: GET/POST /chats, GET/POST /chats/:chatId/messages, PATCH /chats/:chatId/messages/:messageId/read, DELETE /chats/:chatId/messages/:messageId |

#### ×§×‘×¦×™× ×©×ª×•×§× ×• âœ…

| ×§×•×‘×¥ | ×©×•×¨×” | ×ª×™×§×•×Ÿ |
|------|------|-------|
| `apps/api/src/routes/v1/index.ts` | 42 | ×”×•×¡×¤×ª `await app.register(import('./chats.routes.js'), { prefix: '/chats' })` |
| `apps/web/src/api/services/responseService.js` | 102 | ×”×•×¡×¤×ª ×¤×•× ×§×¦×™×™×ª `getUserResponses(userId, params)` |
| `apps/web/src/api/services/socketService.js` | 6-12 | ×ª×™×§×•×Ÿ `getSocketUrl()` - ×”×¡×¨×ª `/api/v1` ××›×ª×•×‘×ª ×”-WebSocket |
| `apps/web/src/pages/Profile.jsx` | 322 | ×”×•×¡×¤×ª `aria-describedby="delete-post-description"` |
| `apps/web/src/pages/UserProfile.jsx` | 449 | ×”×•×¡×¤×ª `aria-describedby="message-dialog-description"` |
| `apps/web/src/pages/AdminUserManagement.jsx` | 321 | ×”×•×¡×¤×ª `aria-describedby="user-details-description"` |

#### ×¤×™×¨×•×˜ ×ª×™×§×•× ×™×

**10.1: Chat Routes Missing (404)**

```typescript
// apps/api/src/services/chat.service.ts - ×©×™×¨×•×ª chat ×—×“×©
export const chatService = {
  async getUserChats(userId, options) { ... },
  async getChatById(chatId, userId) { ... },
  async createOrGetChat(userId, otherUserId, isTemporary) { ... },
  async getMessages(chatId, userId, options) { ... },
  async sendMessage(chatId, senderId, data) { ... },
  async markMessageAsRead(messageId, userId) { ... },
  async deleteMessage(messageId, userId) { ... },
};
```

**10.2: responseService.getUserResponses Missing**

```javascript
// apps/web/src/api/services/responseService.js
async getUserResponses(userId, params = {}) {
  const response = await apiClient.get('/responses', {
    params: { ...params, userId, user_id: userId },
  });
  return {
    responses: response.data.data || response.data.responses || [],
    total: response.data.total || response.data.pagination?.total || 0,
  };
},
```

**10.3: Socket Connection Invalid Namespace**

```javascript
// apps/web/src/api/services/socketService.js
const getSocketUrl = () => {
  if (import.meta.env.VITE_WS_URL) {
    return import.meta.env.VITE_WS_URL.replace('ws://', 'http://').replace('wss://', 'https://');
  }
  const apiUrl = import.meta.env.VITE_API_URL || 'http://localhost:3000/api/v1';
  return apiUrl.replace(/\/api\/v1\/?$/, '');  // ×”×¡×¨×ª /api/v1 ××›×ª×•×‘×ª socket
};
```

**10.4: aria-describedby Accessibility Warnings**

```jsx
// ×ª×•×¡×¤×ª ×œ×›×œ DialogContent
<DialogContent aria-describedby="unique-description-id">
  <DialogTitle>...</DialogTitle>
  <p id="unique-description-id">×ª×™××•×¨ ×”×“×™××œ×•×’</p>
</DialogContent>
```

#### ×‘×“×™×§×•×ª

**×‘×“×™×§×ª Chat Routes:**
```bash
curl -s http://localhost:3000/api/v1/chats
# ×ª×•×¦××”: {"success":false,"error":{"code":"UNAUTHORIZED",...}} âœ… (×œ× 404!)
```

**TypeScript Build:**
```bash
cd apps/api && npm run build
# ×ª×•×¦××”: ××¤×¡ ×©×’×™××•×ª âœ…
```

---

### ISSUE-009: TypeScript Errors - Chat Service & Routes (19 ×©×’×™××•×ª)

**×¡×˜×˜×•×¡:** âœ… ×ª×•×§×Ÿ
**×—×•××¨×”:** ğŸ”´ ×§×¨×™×˜×™
**×ª××¨×™×š ×–×™×”×•×™:** 4 ×¤×‘×¨×•××¨ 2026
**×ª××¨×™×š ×ª×™×§×•×Ÿ:** 4 ×¤×‘×¨×•××¨ 2026

#### ×ª×™××•×¨ ×”×‘×¢×™×”
×©×’×™××•×ª TypeScript ×‘×§×•×‘×¥ `chat.service.ts` ×•-`chats.routes.ts`:
- ×©×™××•×© ×‘×©×“×” `nickname` ×©×œ× ×§×™×™× ×‘-Prisma schema (User model ××©×ª××© ×‘-`firstName` ×•-`lastName`)
- ×™×™×‘×•× `AuthenticatedRequest` ×©×œ× ××™×•×¦× ×-auth.middleware.ts

#### ×§×‘×¦×™× ×©×ª×•×§× ×• âœ…

| ×§×•×‘×¥ | ×©×•×¨×•×ª | ×ª×™×§×•×Ÿ |
|------|-------|-------|
| `chat.service.ts` | 32, 41, 109, 118 | `nickname` â†’ `firstName` + `lastName` ×‘×©××™×œ×ª×•×ª Prisma |
| `chat.service.ts` | 67, 141, 245, 312 | `nickname: xxx` â†’ `first_name: xxx, last_name: xxx` ×‘×ª×©×•×‘×•×ª |
| `chat.service.ts` | 220, 293 | ×ª×™×§×•×Ÿ sender select clause |
| `chats.routes.ts` | 6-8 | ×”×¡×¨×ª ×™×™×‘×•× ×œ× × ×—×•×¥ ×©×œ `AuthenticatedRequest` |
| `chats.routes.ts` | ×›×œ ×”×§×•×‘×¥ | `AuthenticatedRequest` â†’ `FastifyRequest` |

#### ×‘×“×™×§×•×ª

**×”×¨×¦×ª TypeScript check:**
```bash
cd apps/api && npm run typecheck
```

**×ª×•×¦××”:** ××¤×¡ ×©×’×™××•×ª âœ…

---

### ISSUE-008: Undefined Array Access - Cannot read properties of undefined (reading '0')

**×¡×˜×˜×•×¡:** âœ… ×ª×•×§×Ÿ
**×—×•××¨×”:** ğŸ”´ ×§×¨×™×˜×™
**×ª××¨×™×š ×–×™×”×•×™:** 4 ×¤×‘×¨×•××¨ 2026
**×ª××¨×™×š ×ª×™×§×•×Ÿ:** 4 ×¤×‘×¨×•××¨ 2026

#### ×ª×™××•×¨ ×”×‘×¢×™×”
×©×’×™××ª `TypeError: Cannot read properties of undefined (reading '0')` ×•-`Cannot read properties of null (reading 'length')` ×‘×¢××•×“ SharedSpace/FeedPost.

#### ××§×•×¨ ×”×‘×¢×™×”
×’×™×©×” ×œ××¢×¨×›×™× ×©×™×›×•×œ×™× ×œ×”×™×•×ª undefined ××• null ×œ×œ× ×‘×“×™×§×” ××§×“×™××”:

```javascript
// ×“×•×’××” ×œ×‘×¢×™×”:
userData.profile_images[0]  // ×§×•×¨×¡ ×× profile_images ×”×•× undefined
mentionedUsers.length > 0   // ×§×•×¨×¡ ×× mentionedUsers ×”×•× null
```

#### ×§×‘×¦×™× ×©×ª×•×§× ×• âœ…

| ×§×•×‘×¥ | ×©×•×¨×” | ×ª×™×§×•×Ÿ |
|------|------|-------|
| `FeedPost.jsx` | 174 | `userData.profile_images?.[0] \|\| fallbackUrl` |
| `FeedPost.jsx` | 214 | `mentionedUsers={mentionedUsers \|\| []}` |
| `FeedPost.jsx` | 223 | `mentionedUsers?.length > 0` |
| `CommentsList.jsx` | 69 | `userData.profile_images?.[0] \|\| fallbackUrl` |
| `Onboarding.jsx` | 93 | `authUser.profile_images?.[0] \|\| ''` |
| `Onboarding.jsx` | 160 | `formData.profile_images?.[0] \|\| ''` |
| `HeartResponseSelector.jsx` | 95 | `existingResponses?.length > 0` |
| `StarSendersModal.jsx` | 49 | `starLikes?.length > 0` |

#### ×‘×“×™×§×•×ª ×©× ×•×¡×¤×• âœ…

**×§×•×‘×¥:** `apps/web/src/components/feed/FeedPost.test.jsx`

```javascript
describe('Defensive checks for undefined arrays', () => {
  it('should handle undefined profile_images gracefully');
  it('should handle empty profile_images array gracefully');
  it('should handle null profile_images gracefully');
  it('should display fallback image when profile_images is undefined');
});

describe('Response rendering', () => {
  it('should handle response without user_id');
  it('should handle response with demo user_id');
});
```

**×”×¨×¦×ª ×‘×“×™×§×•×ª:**
```bash
cd apps/web && npm run test
```

**×ª×•×¦××”:** 6/6 ×‘×“×™×§×•×ª ×¢×•×‘×¨×•×ª âœ…

---

### ISSUE-007: ×¢×™×¨×‘×•×‘ ×ª××•× ×•×ª ×¤×¨×•×¤×™×œ ×•×¦×™×•×¨×™× (Drawing vs Photos)

**×¡×˜×˜×•×¡:** âœ… ×ª×•×§×Ÿ
**×—×•××¨×”:** ğŸ”´ ×§×¨×™×˜×™
**×ª××¨×™×š ×–×™×”×•×™:** 4 ×¤×‘×¨×•××¨ 2026
**×ª××¨×™×š ×ª×™×§×•×Ÿ:** 4 ×¤×‘×¨×•××¨ 2026

#### ×ª×™××•×¨ ×”×‘×¢×™×”
×‘×©×œ×‘ 8 ×©×œ ×”-Onboarding ("Add Your Photos") ××•×¦×’×™× ×’× ×¦×™×•×¨×™× (drawings) ×©× ×•×¦×¨×• ×‘×©×œ×‘ 13, ×‘××§×•× ×¨×§ ×ª××•× ×•×ª ×¤×¨×•×¤×™×œ ×××™×ª×™×•×ª.

#### ××§×•×¨ ×”×‘×¢×™×”

**1. ×©×“×” ×—×¡×¨ ×‘-Schema:**
```
×§×•×‘×¥: apps/api/prisma/schema.prisma
×‘×¢×™×”: ××™×Ÿ ×©×“×” drawingUrl ×‘××•×“×œ User
```
×”-Frontend ×× ×¡×” ×œ×©××•×¨ `drawing_url` ××‘×œ ×”×©×“×” ×œ× ×§×™×™× ×‘-backend.

**2. uploadService ××¢×¨×‘×‘ ×¡×•×’×™ ×§×‘×¦×™×:**
```javascript
// ×§×•×‘×¥: apps/web/src/api/services/uploadService.js:80-97
async uploadFile(file) {
  const isImage = file.type.startsWith('image/');
  if (isImage) {
    result = await this.uploadProfileImage(file);  // ×’× ×¦×™×•×¨×™× × ×©×œ×—×™× ×œ×›××Ÿ!
  }
}
```
×›×œ ×§×•×‘×¥ ×ª××•× ×” (×›×•×œ×œ ×¦×™×•×¨×™× PNG) × ×©×œ×— ×œ-`uploadProfileImage()`.

**3. ××™×Ÿ ×”×¤×¨×“×” ×‘×™×Ÿ ×¡×•×’×™ ××“×™×” ×‘××•× ×‘×•×¨×“×™× ×’:**
```javascript
// ×§×•×‘×¥: apps/web/src/pages/Onboarding.jsx
// ×©×œ×‘ 8 (×©×•×¨×•×ª 1000-1146): ××¦×™×’ profile_images
// ×©×œ×‘ 13 (×©×•×¨×•×ª 1444-1656): ×©×•××¨ ×¦×™×•×¨ ×œ-drawing_url (×©×“×” ×œ× ×§×™×™×!)
```

#### ×”×©×¤×¢×”
- ×¦×™×•×¨×™× ××•×¤×™×¢×™× ×›×ª××•× ×•×ª ×¤×¨×•×¤×™×œ
- × ×ª×•× ×™× × ×©××¨×™× ×‘×©×“×” ×œ× ×§×™×™× (drawing_url)
- ×—×•×¡×¨ ×¢×§×‘×™×•×ª ×‘× ×ª×•× ×™ ×”××©×ª××©
- ×—×•×•×™×™×ª ××©×ª××© ×¤×’×•××”

#### ×¤×ª×¨×•×Ÿ × ×“×¨×©

**×©×œ×‘ 1: ×¢×“×›×•×Ÿ Prisma Schema**
```prisma
model User {
  // ...existing fields...
  profileImages         String[]
  drawingUrl            String?   // ×¦×™×•×¨ ××”××•× ×‘×•×¨×“×™× ×’ (×—×“×©)
  sketchMethod          String?   // 'self' | 'guess' | 'draw' (×—×“×©)
  // ...
}
```

**×©×œ×‘ 2: ×”×¤×¨×“×ª endpoints ×œ×”×¢×œ××”**
```javascript
// uploadService.js - ×”×•×¡×¤×ª endpoint × ×¤×¨×“ ×œ×¦×™×•×¨×™×
async uploadDrawing(file) {
  const formData = new FormData();
  formData.append('file', file);
  const response = await apiClient.post('/uploads/drawing', formData, {
    headers: { 'Content-Type': 'multipart/form-data' },
  });
  return response.data.data || response.data;
}
```

**×©×œ×‘ 3: ×¢×“×›×•×Ÿ Onboarding.jsx**
- ×©×œ×‘ 8: ×œ×”×¦×™×’ ×¨×§ `profile_images` (×œ×œ× ×¦×™×•×¨×™×)
- ×©×œ×‘ 13: ×œ×©××•×¨ ×¦×™×•×¨ ×‘-`drawingUrl` ×‘×××¦×¢×•×ª `uploadDrawing()`

**×©×œ×‘ 4: ×¢×“×›×•×Ÿ backend routes**
- ×”×•×¡×¤×ª route ×—×“×©: `POST /api/v1/uploads/drawing`
- ×”×•×¡×¤×ª ×©×“×•×ª ×œ××•×“×œ User

#### ×§×‘×¦×™× ×©×ª×•×§× ×• âœ…
1. `apps/api/prisma/schema.prisma` - âœ… ×”×•×¡×¤×ª drawingUrl, sketchMethod
2. `apps/api/src/routes/v1/uploads.routes.ts` - âœ… ×”×•×¡×¤×ª /drawing endpoint
3. `apps/api/src/services/storage.service.ts` - âœ… ×”×•×¡×¤×ª uploadFile method
4. `apps/web/src/api/services/uploadService.js` - âœ… ×”×•×¡×¤×ª uploadDrawing()
5. `apps/web/src/api/client/apiClient.js` - âœ… ×”×•×¡×¤×ª request transformer (snake_case â†’ camelCase)
6. `apps/web/src/pages/Onboarding.jsx` - âœ… ×©×™××•×© ×‘-uploadDrawing ×‘×©×œ×‘ 13
7. `docs/PRD.md` ×¡×¢×™×£ 4.4.1 - âœ… ×”×‘×”×¨×” ×¢×œ ×”×”×¤×¨×“×” ×‘×™×Ÿ photos ×œ-drawings

#### ×¤×ª×¨×•×Ÿ ×©×™×•×©×
```
1. ×”×•×¡×¤×ª ×©×“×•×ª ×—×“×©×™× ×‘-Prisma Schema:
   - drawingUrl: String?  // ×¦×™×•×¨ ××”××•× ×‘×•×¨×“×™× ×’
   - sketchMethod: String?  // 'self' | 'guess' | 'draw'

2. ×™×¦×™×¨×ª endpoint × ×¤×¨×“ ×œ×”×¢×œ××ª ×¦×™×•×¨×™×:
   POST /api/v1/uploads/drawing
   - ×©×•××¨ ×œ×ª×™×§×™×™×ª 'drawings' × ×¤×¨×“×ª
   - ××¢×“×›×Ÿ ××ª drawingUrl ×©×œ ×”××©×ª××© (×œ× profileImages!)

3. ×”×¤×¨×“×” ×‘-uploadService:
   - uploadProfileImage() â†’ ×œ×ª××•× ×•×ª ×¤×¨×•×¤×™×œ
   - uploadDrawing() â†’ ×œ×¦×™×•×¨×™×

4. Request transformer ×‘-apiClient:
   - ×××™×¨ snake_case ×œ-camelCase ×‘×‘×§×©×•×ª ×™×•×¦××•×ª
   - ××‘×˜×™×— ×”×ª×××” ×œ×©××•×ª ×©×“×•×ª ×‘-Prisma
```

#### ×‘×“×™×§×•×ª ×©× ×•×¡×¤×• âœ…

**Backend Unit Tests:**
- `apps/api/src/services/storage.service.test.ts`
  - ×‘×“×™×§×•×ª uploadFile ×œ×ª×™×§×™×™×ª drawings
  - ×‘×“×™×§×•×ª ×”×¤×¨×“×” ×‘×™×Ÿ profiles ×œ-drawings
  - ×‘×“×™×§×•×ª validation ×œ×¡×•×’×™ ×§×‘×¦×™×

**Frontend E2E Tests:**
- `apps/web/e2e/onboarding-drawing.spec.ts`
  - ×‘×“×™×§×•×ª ×©×œ×‘ 8 (Add Your Photos) - ×¨×§ ×ª××•× ×•×ª
  - ×‘×“×™×§×•×ª ×©×œ×‘ 13 (Drawing) - ×¦×™×•×¨ × ×©××¨ ×œ-drawingUrl
  - ×‘×“×™×§×•×ª ×”×¤×¨×“×” ×§×¨×™×˜×™×•×ª ×‘×™×Ÿ photos ×œ-drawings

- `apps/web/e2e/api-client.spec.ts`
  - ×‘×“×™×§×•×ª transformer (snake_case â†” camelCase)
  - ×‘×“×™×§×•×ª ×¡×¤×¦×™×¤×™×•×ª ×œ-drawing_url ×•-profile_images

**×”×¨×¦×ª ×‘×“×™×§×•×ª:**
```bash
# Backend unit tests
cd apps/api && npm test

# Frontend E2E tests
cd apps/web && npm run test:e2e
```

#### ×”×¢×¨×•×ª
- drawings ×©× ×•×¦×¨×™× ×‘××•× ×‘×•×¨×“×™× ×’ ×©×•× ×™× ×-DRAWING responses ×œ××¡×™××•×ª
- ×ª××•× ×•×ª ×¤×¨×•×¤×™×œ = ×ª××•× ×•×ª ×××™×ª×™×•×ª ××§×•×‘×¥/××¦×œ××”
- ×¦×™×•×¨×™× = ××•×× ×•×ª ×©× ×•×¦×¨×ª ×¢× ×”×¦×™×™×¨ (×›××• ×•×™×“××•/××•×“×™×•/×˜×§×¡×˜)

---

## âœ… ×ª×§×œ×•×ª ×©×ª×•×§× ×•

### ISSUE-006: Frontend API Errors (5 ×©×’×™××•×ª) - 4 ×¤×‘×¨×•××¨ 2026

**×¡×˜×˜×•×¡:** âœ… ×ª×•×§×Ÿ
**×—×•××¨×”:** ğŸ”´ ×§×¨×™×˜×™
**××§×•×¨:** Console errors ×‘×“×¤×“×¤×Ÿ

#### 6.1: userService.updateUser is not a function
**×§×•×‘×¥ ××•×©×¤×¢:** `apps/web/src/pages/Onboarding.jsx:1046`
**×ª×™××•×¨:** ×”×¤×•× ×§×¦×™×” `userService.updateUser()` × ×§×¨××” ××š ×œ× ×”×™×™×ª×” ××•×’×“×¨×ª ×‘-userService
**×¤×ª×¨×•×Ÿ:** ×”×•×¡×¤×ª ×¤×•× ×§×¦×™×™×ª `updateUser` ×‘-`apps/web/src/api/services/userService.js:86`
```javascript
async updateUser(userId, data) {
  const response = await apiClient.patch(`/users/${userId}`, data);
  return response.data;
}
```

#### 6.2: POST /api/v1/responses 400 (Bad Request)
**×§×‘×¦×™× ××•×©×¤×¢×™×:**
- `apps/web/src/pages/WriteTask.jsx:87`
- `apps/web/src/pages/AudioTask.jsx:113`
- `apps/web/src/pages/VideoTask.jsx:112`

**×ª×™××•×¨:** Backend ××¦×¤×” ×œ-responseType ×‘××•×ª×™×•×ª ×’×“×•×œ×•×ª (`'TEXT'`, `'VOICE'`, `'VIDEO'`) ××‘×œ Frontend ×©×œ×— ×‘××•×ª×™×•×ª ×§×˜× ×•×ª
**×¤×ª×¨×•×Ÿ:** ×©×™× ×•×™ ×”×¢×¨×›×™×:
- `'text'` â†’ `'TEXT'`
- `'voice'` â†’ `'VOICE'`
- `'video'` â†’ `'VIDEO'`

#### 6.3: GET /api/v1/users/undefined 404 (Not Found)
**×§×•×‘×¥ ××•×©×¤×¢:** `apps/web/src/components/feed/FeedPost.jsx:118`
**×ª×™××•×¨:** ×§×¨×™××” ×œ-API ×¢× `user_id` ×©×”×•× `undefined`
**×¤×ª×¨×•×Ÿ:** ×”×•×¡×¤×ª ×‘×“×™×§×” ×‘-`FeedPost.jsx:106`:
```javascript
if (!response.user_id) {
  setUserData({ nickname: '××©×ª××©', ... });
  return;
}
```

#### 6.4: Field naming mismatch (camelCase vs snake_case)
**×§×•×‘×¥ ××•×©×¤×¢:** `apps/web/src/api/client/apiClient.js`
**×ª×™××•×¨:** Backend ××—×–×™×¨ ×©×“×•×ª ×‘-camelCase (`userId`) ××‘×œ Frontend ××¦×¤×” ×œ-snake_case (`user_id`)
**×¤×ª×¨×•×Ÿ:** ×”×•×¡×¤×ª transformer ×‘-apiClient ×©×××™×¨ ××•×˜×•××˜×™×ª ××ª ×©××•×ª ×”×©×“×•×ª:
```javascript
function transformKeysToSnakeCase(obj) { ... }
// Added to response interceptor
```

**×‘×“×™×§×•×ª × ×“×¨×©×•×ª:**
- [x] ×‘×“×™×§×” ×©×©××™×¨×ª ×ª××•× ×•×ª ×¢×•×‘×“×ª ×‘-Onboarding âœ… (unit tests pass - 140/140)
- [x] ×‘×“×™×§×” ×©×©××™×¨×ª ×˜×§×¡×˜/××•×“×™×•/×•×™×“××• ×¢×•×‘×“×ª âœ… (unit tests pass)
- [x] ×‘×“×™×§×” ×©××™×Ÿ ×©×’×™××•×ª 404 ×‘-FeedPost âœ… (null check added)
- [x] ×‘×“×™×§×” ×©× ×ª×•× ×™ ××©×ª××© ××•×¦×’×™× × ×›×•×Ÿ âœ… (transformer working)

---

### ISSUE-001: TypeScript Build Errors (30 ×©×’×™××•×ª)

**×¡×˜×˜×•×¡:** âœ… ×ª×•×§×Ÿ
**×§×‘×¦×™× ×©×ª×•×§× ×•:**

| ×§×•×‘×¥ | ×ª×™×§×•×Ÿ |
|------|-------|
| `jwt.util.ts` | ×”×•×¡×¤×ª ×©×“×” `id` ×œ-JWTPayload interface |
| `admin.controller.ts` | ×”×¡×¨×ª ××©×ª× ×™× ×œ× ×‘×©×™××•×©, prefix `_` ×œ×¤×¨××˜×¨×™× |
| `responses.controller.ts` | ×”×•×¡×¤×ª `!` assertion ×œ-request.user |
| `uploads.routes.ts` | ×”×—×œ×¤×ª `reply.status()` ×‘-`reply.code()`, ×”×¡×¨×ª schema ×œ× ×ª×§×™×Ÿ |
| `oauth.routes.ts` | prefix `_` ×œ×¤×¨××˜×¨ request ×œ× ×‘×©×™××•×© |
| `analytics.service.ts` | ×©×™× ×•×™ import ×œ× ×‘×©×™××•×© ×œtype import |
| `google-oauth.service.ts` | ×”×•×¡×¤×ª type assertion |
| `likes.service.ts` | ×”×¡×¨×ª interface ×œ× ×‘×©×™××•×© |
| `storage.service.ts` | ×”×¡×¨×ª import ×œ× ×‘×©×™××•×© |

---

### ISSUE-002: Unit Test Failures (2 ×›×©×œ×•× ×•×ª)

**×¡×˜×˜×•×¡:** âœ… ×ª×•×§×Ÿ
**×§×•×‘×¥:** `apps/api/src/services/auth.service.test.ts`

**×¤×ª×¨×•×Ÿ:**
×”×•×¡×¤×ª reset ×©×œ mock return values ×‘-`beforeEach` ×œ××—×¨ `vi.clearAllMocks()`:
```typescript
beforeEach(() => {
  vi.clearAllMocks();
  vi.mocked(generateAccessToken).mockReturnValue('mock-access-token');
  vi.mocked(generateRefreshToken).mockReturnValue('mock-refresh-token');
  vi.mocked(verifyRefreshToken).mockReturnValue({ userId: 'test-user-id' });
});
```

**×ª×•×¦××”:** 34/34 ×‘×“×™×§×•×ª ×¢×•×‘×¨×•×ª

---

### ISSUE-003: ESLint Configuration Missing

**×¡×˜×˜×•×¡:** âœ… ×ª×•×§×Ÿ
**×¤×ª×¨×•×Ÿ:** × ×•×¦×¨ ×§×•×‘×¥ `eslint.config.js` ×‘×¤×•×¨××˜ Flat Config ×©×œ ESLint v9

**×§×•×‘×¥ ×—×“×©:** `apps/api/eslint.config.js`

---

### ISSUE-004: Missing typecheck Script

**×¡×˜×˜×•×¡:** âœ… ×ª×•×§×Ÿ
**×¤×ª×¨×•×Ÿ:** × ×•×¡×£ ×¡×§×¨×™×¤×˜ ×œ-package.json:
```json
"typecheck": "tsc --noEmit"
```

---

### ISSUE-005: Test Mock Hoisting Errors (2 ×©×’×™××•×ª)

**×¡×˜×˜×•×¡:** âœ… ×ª×•×§×Ÿ
**×§×‘×¦×™× ×©×ª×•×§× ×•:**

| ×§×•×‘×¥ | ×‘×¢×™×” | ×¤×ª×¨×•×Ÿ |
|------|------|-------|
| `subscriptions.service.test.ts` | "Cannot access 'mockPrisma' before initialization" | ×”×¢×‘×¨×ª ×”×’×“×¨×ª mock ×œ×ª×•×š vi.mock() factory |
| `push-notifications.service.test.ts` | "Cannot access 'mockPrisma' before initialization" | ×”×¢×‘×¨×ª ×”×’×“×¨×ª mock ×œ×ª×•×š vi.mock() factory |

**×”×¡×‘×¨ ×”×‘×¢×™×”:**
×§×¨×™××•×ª `vi.mock()` ×¢×•×‘×¨×•×ª hoisting ×œ×¨××© ×”×§×•×‘×¥ ×‘×–××Ÿ ×¨×™×¦×”. ×›×ª×•×¦××” ××›×š, factory function ×©×œ vi.mock() ×¨×¦×” ×œ×¤× ×™ ×©×”××©×ª× ×” `mockPrisma` ××•×’×“×¨.

**×¤×ª×¨×•×Ÿ:**
```typescript
// ×œ×¤× ×™ (×©×’×•×™):
const mockPrisma = { ... };
vi.mock('../lib/prisma.js', () => ({ prisma: mockPrisma }));

// ××—×¨×™ (×ª×§×™×Ÿ):
import { prisma } from '../lib/prisma.js';
vi.mock('../lib/prisma.js', () => ({
  prisma: { ... }, // ×”×’×“×¨×” ×™×©×™×¨×” ×‘×ª×•×š factory
}));
const mockPrisma = vi.mocked(prisma);
```

**×ª×•×¦××”:** 123/123 ×‘×“×™×§×•×ª ×¢×•×‘×¨×•×ª

---

## ğŸ“ ×”×¢×¨×•×ª × ×•×¡×¤×•×ª

### E2E Tests Status

×‘×“×™×§×•×ª E2E ×“×•×¨×©×•×ª ×”×¤×¢×œ×ª ×©×¨×ª ×¤×™×ª×•×— ×œ×¤× ×™ ×”×¨×¦×”:
```bash
# ×”×¤×¢×œ×ª ×©×¨×ª
npm run dev

# ×”×¨×¦×ª ×‘×“×™×§×•×ª E2E
npm run test:e2e
```

### ×¤×§×•×“×•×ª ×‘×“×™×§×”

```bash
# ×‘×“×™×§×•×ª ×™×—×™×“×”
cd apps/api && npm test

# ×‘×“×™×§×•×ª ×¢× ×›×™×¡×•×™
cd apps/api && npm run test:coverage

# ×‘×“×™×§×ª TypeScript
cd apps/api && npm run typecheck

# ×‘×“×™×§×ª ESLint
cd apps/api && npm run lint

# Build
cd apps/api && npm run build
```

---

## ×”×™×¡×˜×•×¨×™×™×ª ×¢×“×›×•× ×™×

| ×ª××¨×™×š | ×¤×¢×•×œ×” | ×¡×˜×˜×•×¡ |
|-------|-------|-------|
| ×¤×‘×¨×•××¨ 2026 | ×–×™×”×•×™ ×¨××©×•× ×™ | ğŸ”´ 34 ×ª×§×œ×•×ª ×–×•×”×• |
| ×¤×‘×¨×•××¨ 2026 | ×ª×™×§×•×Ÿ TypeScript Build | âœ… 30 ×©×’×™××•×ª ×ª×•×§× ×• |
| ×¤×‘×¨×•××¨ 2026 | ×ª×™×§×•×Ÿ Unit Tests | âœ… 2 ×›×©×œ×•× ×•×ª ×ª×•×§× ×• |
| ×¤×‘×¨×•××¨ 2026 | ×ª×™×§×•×Ÿ ESLint Config | âœ… × ×•×¦×¨ eslint.config.js |
| ×¤×‘×¨×•××¨ 2026 | ×”×•×¡×¤×ª typecheck script | âœ… × ×•×¡×£ ×œpackage.json |
| ×¤×‘×¨×•××¨ 2026 | ×ª×™×§×•×Ÿ Test Mock Hoisting | âœ… 2 ×§×‘×¦×™ ×‘×“×™×§×•×ª ×ª×•×§× ×• |
| ×¤×‘×¨×•××¨ 2026 | ×¡×™×•× ×˜×™×¤×•×œ ×¨××©×•× ×™ | âœ… 36 ×ª×§×œ×•×ª ×ª×•×§× ×• |
| 4 ×¤×‘×¨×•××¨ 2026 | ×ª×™×§×•×Ÿ userService.updateUser | âœ… ×”×•×¡×¤×ª ×¤×•× ×§×¦×™×” ×—×¡×¨×” |
| 4 ×¤×‘×¨×•××¨ 2026 | ×ª×™×§×•×Ÿ responseType case | âœ… ×©×™× ×•×™ ×œ-uppercase |
| 4 ×¤×‘×¨×•××¨ 2026 | ×ª×™×§×•×Ÿ undefined user_id | âœ… ×”×•×¡×¤×ª ×‘×“×™×§×ª null |
| 4 ×¤×‘×¨×•××¨ 2026 | ×ª×™×§×•×Ÿ camelCase/snake_case | âœ… ×”×•×¡×¤×ª transformer |
| 4 ×¤×‘×¨×•××¨ 2026 | ×¡×™×•× ×˜×™×¤×•×œ ×¨××©×•× ×™ | âœ… 41 ×ª×§×œ×•×ª ×ª×•×§× ×• |
| 4 ×¤×‘×¨×•××¨ 2026 | ×ª×™×§×•×Ÿ ×¢×™×¨×‘×•×‘ ×¦×™×•×¨×™×/×ª××•× ×•×ª (ISSUE-007) | âœ… ×”×¤×¨×“×ª endpoints + schema |
| 4 ×¤×‘×¨×•××¨ 2026 | ×ª×™×§×•×Ÿ Undefined Array Access (ISSUE-008) | âœ… 5 ×§×‘×¦×™× ×ª×•×§× ×• + 6 ×‘×“×™×§×•×ª unit |
| 4 ×¤×‘×¨×•××¨ 2026 | ×ª×™×§×•×Ÿ TypeScript Chat Service (ISSUE-009) | âœ… 19 ×©×’×™××•×ª ×ª×•×§× ×• |
| 4 ×¤×‘×¨×•××¨ 2026 | ×ª×™×§×•×Ÿ Console Errors (ISSUE-010) | âœ… Chat routes, Socket URL, A11y warnings |
| 4 ×¤×‘×¨×•××¨ 2026 | **×¡×™×•× Phase 6** | âœ… **×›×œ 70 ×”×ª×§×œ×•×ª ×ª×•×§× ×•** |
| 4 ×¤×‘×¨×•××¨ 2026 | **Polish: State Components** | âœ… LoadingState, EmptyState, ErrorState |
| 4 ×¤×‘×¨×•××¨ 2026 | ×¢×“×›×•×Ÿ 40+ ×“×¤×™× ×¢× State Components | âœ… ×›×œ ×”×“×¤×™× ×¢×•×“×›× ×• |
| 4 ×¤×‘×¨×•××¨ 2026 | **E2E Testing: Playwright** | âœ… 7 ×§×‘×¦×™ ×‘×“×™×§×” ×—×“×©×™×, ~224 ×‘×“×™×§×•×ª |
| 6 ×¤×‘×¨×•××¨ 2026 | ×ª×™×§×•×Ÿ CORS header conflict (ISSUE-012.1) | âœ… security.config.ts |
| 6 ×¤×‘×¨×•××¨ 2026 | ×ª×™×§×•×Ÿ Chat 400 Bad Request (ISSUE-012.2) | âœ… 3 ×©×›×‘×•×ª ×”×’× ×” |
| 6 ×¤×‘×¨×•××¨ 2026 | ×ª×™×§×•×Ÿ Location Object Rendering (ISSUE-012.3) | âœ… formatLocation utility |
| 6 ×¤×‘×¨×•××¨ 2026 | ×™×¦×™×¨×ª userTransformer (ISSUE-012.4) | âœ… centralized data transformation |
| 6 ×¤×‘×¨×•××¨ 2026 | **×‘×“×™×§×•×ª ×—×“×©×•×ª** | âœ… userTransformer.test.js, chatService.test.js |
| 6 ×¤×‘×¨×•××¨ 2026 | ×ª×™×§×•×Ÿ Onboarding save error (ISSUE-013) | âœ… validation ×‘-userService + Onboarding |
| 6 ×¤×‘×¨×•××¨ 2026 | **AUDIT-001: API Validation Hardening** | âœ… 8 services + validation utility |
| 6 ×¤×‘×¨×•××¨ 2026 | **ISSUE-014: Database Empty + Date Issues** | âœ… seed data + field aliases |
| 6 ×¤×‘×¨×•××¨ 2026 | ×”×•×¡×¤×ª Admin User ×œ×¡×™×“ | âœ… admin@bellor.app |
| 6 ×¤×‘×¨×•××¨ 2026 | ×ª×™×§×•×Ÿ Invalid Date ×‘-Creation | âœ… apiClient field aliases |
| 8 ×¤×‘×¨×•××¨ 2026 | **TASK-009: Architecture Diagrams (Mermaid)** | âœ… 8 diagrams in docs/ARCHITECTURE.md |
| 8 ×¤×‘×¨×•××¨ 2026 | **TASK-012: Prometheus Alert Rules** | âœ… P1-P4 severity tiers, WebSocket, Database alerts |
| 8 ×¤×‘×¨×•××¨ 2026 | **TASK-013: PII Data Retention Policy** | âœ… GDPR/CCPA compliance, retention schedule, deletion procedures |

